#/usr/bin/Rscript
# This script plots the direct log fold change (lfc, x-axis) versus the moderated log-ratios (mod_lfc, y-axis).
# [From DESeq documentation] 'The moderation criterion used is variance stabilization.
# The points are colored in a scale from gray to blue, representing weakly to strongly expressed genes.
# The purple points correspond to values that were infinite in lfc and were arbitrarily set to +/- 7 for the purpose of plotting.'

# Vector of log2 fold change values
lfc = c(-7,2.58575129545347,2.73288712422643,-7,-0.415232960902427,-7,-1.8525089846579,-7,0.479204770629006,-0.228889796510651,-7,-7,-7,0.129866898039764,2.68472585474083,1.33417133278281,0.828380680018648,-7,1.73288712422643,-7,-7,-7,1.32231314462427,-0.455332920226142,-7,-7,-7,1.91364177201931,-7,1.40966035039326,-7,-7,2.68472585474083,2.68472585474083,2.68472585474083,-7,2.70498879191344,-0.158457036505425,-7,2.68472585474083,-7,-7,0.3924704250482,-7,-7,0.633396576167314,-7,-0.590863447646611,-0.935187263180842,-7,0.579832704950864,-7,-7,-7,-7,-1.76369940338001,-0.339280505600969,-7,-0.139753614993878,2.73288712422643,-0.172054757575336,2.28248889099537,2.68472585474083,2.22320196758621,0.66027464795355,0.343286100364266,0.0085174880664846,-1.43145324619549,-7,-7,-7,-7,-7,-7,-0.426887383310002,-7,-7,-7,-1.95737661110023,-7,-7,-7,-2.81983599127976,1.68472585474083,2.73288712422643,0.164743791836454,-7,1.27071485129866,-7,-7,-7,-0.420638267569088,2.70441378298026,-7,-7,-7,-7,-7,-1.73498683560897,1.14792462350527,-0.799921407103992,-1.03964378141911,0.108148428256504,0.0341342796736648,-7,0.867567782169337,-0.474008182679635,-7,-7,-0.482321078516488,-7,-1.50252158220362,-7,-7,-1.88621792221802,-7,-7,-7,-7,-0.919478091786908,-7,-7,0.550273412775308,-7,-7,0.315702377023448,-0.848082676589591,-7,2.68472585474083,-7,0.548296541602831,1.20638872958318,-7,-7,0.816495343286948,-7,-1.10822467560835,-0.165941177618524,0.0279191803646803,-7,-7,2.68472585474083,2.58951157449351,-2.84258232796071,0.420602066959808,0.939512932616763,-7,1.68472585474083,-0.156311891861319,-7,1.90155586765317,-7,1.28228431346825,2.70900745019577,-7,-7,-7,2.73288712422643,2.73288712422643,-1.31492794123668,-7,1.31181274030561,0.124657926504115,-0.128582536976451,-7,-7,-7,-7,-7,-7,0.517678921483512,-7,-7,-7,-7,-1.12538534637162,-7,-7,-7,-7,-0.119569147762867,-0.518328579275297,-0.27485348767354,-7,-7,2.73288712422643,-7,-1.89133842258528,-0.803995666598113,-7,-7,-1.12299749164173,2.73288712422643,-7,-7,-7,-7,-7,-1.57644501265467,-7,-0.136901263585577,-0.544055599164212,-7,1.81940651268374,-7,2.73288712422643,-7,-7,-7,-7,-1.37291067097675,1.68472585474083,-0.829104078051058,0.684725854740828,0.282284313468248,-7,-7,-7,1.33044558295385,1.84368810813868,-7,0.118618169189582,-7,2.73288712422643,-7,-7,-7,-1.14656660635591,-7,-3.16225067394919,-7,-2.46567888004232,-0.681664037823345,-1.10669827077703,-1.27771789807834,1.73288712422643,-1.76825134243198,0.362797759853466,-2.71509817868904,-7,-7,-7,-7,-0.495737834039892,-0.281915368147471,-1.39086597673059,-7,0.469517651997913,-1.34272374980203,-7,-2.14529173383744,-7,-7,-7,-7,0.632928308583172,-7,-1.32528123422546,2.68472585474083,1.68472585474083,-0.212837365117564,-7,-1.29567176902899,-7,2.68472585474083,1.84368810813868,2.39906859918955,1.77477673536164,1.46951765199791,-7,2.73288712422643,-0.335771348920081,-7,-7,1.28679473063405,1.11978140007952,-7,2.68472585474083,2.73288712422643,-7,1.33044558295385,1.30656590892319,0.769288451893631,-7,0.447316773581235,2.68472585474083,-7,-7,0.470412027282339,2.68472585474083,-7,-7,-7,-1.44371951102741,-7,-7,0.478812043305981,-7,-7,0.867567782169337,-7,-0.276986870045912,-7,0.597336794339202,-1.20674841963058,-7,-7,-7,-7,0.819406512683738,-1.41565502372921,-7,2.68472585474083,0.974061267293376,-7,-7,-0.843724308747961,0.658162495031381,-1.03307038848382,-7,0.418643250783208,-7,2.15705164565862,-7,-7,-7,2.70095890829574,1.39714730847225,-7,-7,-7,1.09976335401967,-7,-7,1.14792462350527,2.73288712422643,-7,-7,2.68472585474083,-7,0.910671702565142,0.566646117407964,-7,-0.00427957867399122,-7,-7,-0.979687159648094,-7,-7,-7,2.19433858271994,-7,-7,0.0961545272636314,0.200078592896008,2.68472585474083,-7,-7,2.68472585474083,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-0.526226083196188,-7,-7,-7,-7)

# Vector of log2 fold change values, moderated by variance stabilization
mod_lfc = c(0.594225254692853,-2.86050531476024,-0.713056502311424,1.68222271380247,0.671629593145235,0.452362423249829,1.53495352762211,1.29923846203281,-0.540966146725908,0.220192283691773,0.594225254692853,0.594225254692853,1.68222271380247,0.94778187037412,-0.69629182103683,-0.935555491500448,-0.988263284750209,1.82028383743189,-0.504918582072984,0.846876038782976,0.594225254692853,0.452362423249829,-1.310697432376,0.25351071929484,1.62238078975505,1.61214591719345,0.452362423249829,-1.78921688355638,0.452362423249829,-1.94963115969462,0.660500343488269,0.594225254692853,-0.69629182103683,-0.69629182103683,-0.878506926565266,1.29923846203281,-3.19128532207037,0.263549378942084,0.660500343488269,-0.69629182103683,0.452362423249829,1.50737638227125,-0.297513700074584,0.846876038782976,2.49328144320877,-0.528611470443511,0.452362423249829,0.821252189883423,0.957578383221856,0.594225254692853,-0.704644740914,1.04658767794268,0.594225254692853,0.594225254692853,0.594225254692853,1.67501039130092,0.396567217424255,0.594225254692853,0.461194778763722,-0.899582304652231,1.43585356827849,-3.68615815259631,-0.69629182103683,-3.23446579259931,-0.9905559704937,-0.293025591160529,0.744566855476488,1.4021649635815,3.37023640373909,1.04658767794268,0.594225254692853,1.0217223703142,0.594225254692853,0.452362423249829,0.637292497678707,0.594225254692853,0.594225254692853,0.594225254692853,2.44527743461264,0.452362423249829,1.04658767794268,0.846876038782976,2.71432394005506,-0.488153900798391,-0.713056502311424,0.308665868002777,0.452362423249829,-0.844691517783936,0.846876038782976,0.594225254692853,0.452362423249829,0.270643158338305,-5.88656329518072,0.452362423249829,0.594225254692853,2.55753442350801,0.594225254692853,0.452362423249829,2.03142536181365,-0.354960214067173,1.02252010344457,1.15599525933033,0.67443658753318,-0.0574931477597485,0.594225254692853,0.0893066726198686,0.801865415841849,0.452362423249829,0.452362423249829,0.795981595952482,0.594225254692853,1.51471650469955,1.47408479356403,1.29923846203281,2.05339046196846,1.25472559818112,0.452362423249829,0.452362423249829,0.452362423249829,1.10888905111313,0.452362423249829,0.452362423249829,-0.363553509719405,0.452362423249829,1.93699431204306,-0.402922574082865,1.03928478471916,0.846876038782976,-0.69629182103683,0.452362423249829,-0.768750632273999,-1.18330501655011,0.452362423249829,0.452362423249829,-1.05522383888631,1.04658767794268,1.15890000600566,0.264033971653987,0.00399956096140475,0.594225254692853,1.65733475027706,-0.69629182103683,-3.14141761193155,3.2408876161581,-0.282656423008869,-0.589155006394575,1.29923846203281,-0.488153900798391,0.107696602758006,0.594225254692853,-1.69823046845292,0.594225254692853,-0.102066566343977,-2.17029262837973,0.452362423249829,1.40468396618693,1.04658767794268,-0.899582304652231,-0.713056502311424,1.84142887511463,0.594225254692853,-0.841522543843169,0.0277392364281885,0.168513548380944,0.660500343488269,0.452362423249829,1.04658767794268,0.452362423249829,1.47408479356403,0.452362423249829,0.23926504062568,1.40468396618693,0.594225254692853,0.594225254692853,1.25472559818112,1.62212552811793,2.93987929008945,2.0498779053764,0.452362423249829,0.452362423249829,0.151790824849868,0.711947587047143,0.331191678164101,2.0498779053764,1.04658767794268,-0.713056502311424,0.452362423249829,2.48460484812147,0.9222528009221,0.660500343488269,1.25472559818112,1.5573318719379,-0.713056502311424,1.29923846203281,0.594225254692853,1.50737638227125,0.594225254692853,0.594225254692853,2.06442437749209,0.594225254692853,0.393088372728434,0.688669521584646,3.61610845273461,-0.284281671872413,0.452362423249829,-0.713056502311424,1.29923846203281,0.594225254692853,0.594225254692853,0.846876038782976,1.43779686763372,-0.488153900798391,0.919692995559673,-0.219856954472352,0.358722137984586,0.594225254692853,1.50737638227125,0.594225254692853,-0.118831247618571,-1.05934757166679,1.0217223703142,-0.171434801368511,1.29923846203281,-0.713056502311424,1.27649396855479,1.04658767794268,0.594225254692853,1.68440510163048,2.79691367009564,3.0800517397846,3.01561391412513,2.38043933037537,1.70348303206305,1.0291970902333,1.1998921910219,-0.504918582072984,1.9213310713826,-0.120498709224465,3.31472669664981,2.66752699238879,3.92406881429223,1.50737638227125,0.660500343488269,0.759640326052488,0.346163363798725,1.79255024128269,3.88651174009582,0.256029721900273,1.40505952218927,1.25472559818112,2.37831357773977,0.594225254692853,1.04658767794268,0.452362423249829,1.50737638227125,0.133819536471552,1.04658767794268,1.61467763915843,-0.69629182103683,-0.488153900798391,0.268291426990289,1.50737638227125,1.45547665636169,0.660500343488269,-0.69629182103683,-1.05934757166679,-2.51934250195398,-1.39034018077042,-0.134323303866602,0.594225254692853,-0.713056502311424,0.184274210669741,0.452362423249829,0.594225254692853,-1.31309787148968,-1.17137186472675,2.08858078375793,-0.69629182103683,-0.713056502311424,0.594225254692853,-0.118831247618571,-0.806696787576668,-0.46180817626938,0.452362423249829,-0.433475301588683,-0.69629182103683,0.452362423249829,0.594225254692853,-0.440810961069303,-0.69629182103683,1.50737638227125,1.82437488491054,1.04658767794268,1.72763395868593,1.04658767794268,0.594225254692853,-0.72567097874553,0.452362423249829,0.594225254692853,0.0893066726198686,0.452362423249829,0.320822468495637,1.25472559818112,-0.466070191680609,1.75377510450098,0.660500343488269,2.13069218894373,0.452362423249829,1.15978349394363,0.106071353894462,2.12613461084776,1.0217223703142,-0.69629182103683,-0.654548290238393,1.04658767794268,0.594225254692853,0.727030242890997,-0.439041596002742,0.970935543168297,0.452362423249829,0.837443249241915,1.65733475027706,-1.81385312124208,1.65733475027706,0.452362423249829,0.594225254692853,-2.46396194918081,-1.04921201281764,0.594225254692853,0.594225254692853,1.04658767794268,-0.33819553279258,0.594225254692853,0.594225254692853,-0.354960214067173,-0.713056502311424,0.452362423249829,0.594225254692853,-0.69629182103683,0.452362423249829,0.455143475051479,-0.491567062297563,0.452362423249829,0.00889915292930787,0.846876038782976,1.25472559818112,1.06493649754957,1.68222271380247,0.594225254692853,0.452362423249829,-2.65371063130894,0.452362423249829,0.452362423249829,-0.101035742850774,0.62785638086532,-0.878506926565266,1.29923846203281,1.29923846203281,-0.878506926565266,0.660500343488269,0.452362423249829,0.594225254692853,1.61214591719345,0.452362423249829,0.594225254692853,0.594225254692853,0.452362423249829,2.30464950361699,3.88629860560871,3.37859355000288,0.804823279876452,2.66752699238879,3.46228590501282,1.47408479356403,0.452362423249829)

# Boolean vector indicating whether lfc is finite or not
finite = c(FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE)

# Vector of colors
colors = c('#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#7272D8','#BEBEBE','#9898CB','#7272D8','#BEBEBE','#9898CB','#7272D8','#9898CB','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#9898CB','#9898CB','#9898CB','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#9898CB','#7272D8','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/htseq/figures/DESeq/htseq_all_groups_cutoff-0_LNCaP_group-PrEC_group_log2FoldChange-vs-ModeratedLogRatio.pdf')

# Plot of normalized mean versus log2FoldChange
plot(lfc, mod_lfc, pch=20, cex=.4, asp=1, 
						col=ifelse(finite,colors,"purple"),
						main="Direct (lfc) vs Moderated log ratios (mod_lfc)",
						sub="purple were infinite in lfc, arbitrarily set for plotting")
					abline(a=0, b=1, col="#40C04040")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
