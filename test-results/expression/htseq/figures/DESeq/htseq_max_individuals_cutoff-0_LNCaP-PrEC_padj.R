#/usr/bin/Rscript
# This script plots a histogram showing the distribution of p-values adjusted by the Benjamini-Hochberg correction for controlling False Discovery Rate (FDR). 
#See http://en.wikipedia.org/wiki/False_discovery_rate for more information.
#Ideally, a p-value histogram would be flat (uniform distribution), with equal probability of every value.

# Vector of adjusted p-values
padj = c(1,0.00343489802548851,0.367192399855721,1,1,1,0.737265378445807,1,0.884446641909925,1,1,1,1,2.02341658008609e-07,1,1,0.270116985570079,1,1,1,1,1,0.0929131966494742,1,1,0.367192399855721,1,0.204466840319772,1,1,1,1,1,0.000115933977318138,1,1,1,1,1,1,1,1,1,1,1,1,0.511340969160364,1,1,1,1,1,1,1,1,1,1,0.0740761563014153,1,8.63354681075162e-23,1,1.23602342753726e-11,0.121124662096801,1,1,1,1,1,1,1,1,1,1,1,0.517735582316075,1,1,1,1,0.24872792019937,1,1,1,1,0.755052014408823,1,1,1,1,1,2.41198444020228e-20,1,0.174191389058046,1,1,1,0.174191389058046,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.167394956823939,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.205239216564802,0.367192399855721,1,1,0.0876817246909333,1,1,1,1,1,1,1,1,0.174191389058046,1,0.983610904479717,1,1,1,1,0.568895307243363,1,1,0.0696715910699882,1,1,0.00476130188891357,1,1,1,1,0.973810492622768,1,1,1,1,1,1,1,1,1,1,1,0.786420916862836,1,1,0.159486443666556,0.556628041062165,1,1,1,1,1,1,1,1,1,1,1,0.0275560335623251,1,1,0.167394956823939,0.174191389058046,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.154149589341325,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.916478804184541,1,1,1,1,1,1,1,1,1,1,1,0.737265378445807,0.118776656350971,0.906147994296034,0.540005673534039,1,1,1,1,1,0.154149589341325,1,0.0696715910699882,0.22769258622147,0.205201065029153,1,1,0.118776656350971,1,1,0.0740761563014153,1,1,1,1,1,1,1,0.174191389058046,1,1,1,1,0.392600893857814,1,1,1,1,1,1,0.270116985570079,1,0.960991819716647,0.0929131966494742,1,0.0696715910699882,1,1,1,0.14422804528953,1,1,1,0.552578650789372,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.0876817246909333,0.916478804184541,0.181947831587792,1)

# The expression_common.R file sources the DESeq_utils.R file that has the plotting functions we need
source('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/expression_common.R')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/htseq/figures/DESeq/htseq_max_individuals_cutoff-0_LNCaP-PrEC_padj.pdf')

# Plot adjusted p-values on a histogram
pValHist(padj, "LNCaP vs PrEC 
adjusted p-values")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
