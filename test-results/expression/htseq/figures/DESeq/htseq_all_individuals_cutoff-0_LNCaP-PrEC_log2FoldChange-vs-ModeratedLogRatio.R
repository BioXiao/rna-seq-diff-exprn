#/usr/bin/Rscript
# This script plots the direct log fold change (lfc, x-axis) versus the moderated log-ratios (mod_lfc, y-axis).
# [From DESeq documentation] 'The moderation criterion used is variance stabilization.
# The points are colored in a scale from gray to blue, representing weakly to strongly expressed genes.
# The purple points correspond to values that were infinite in lfc and were arbitrarily set to +/- 7 for the purpose of plotting.'

# Vector of log2 fold change values
lfc = c(-7,6.38013031789336,7,-7,-0.0280680983407587,-7,-1.82504521401636,-7,0.79918272731264,-0.159513721007956,-7,-7,-7,0.355939310509257,7,1.93435169448078,1.27922022463038,-7,2.25025958203412,-7,-7,-7,2.09367387888916,-0.552744723300162,-7,-7,-7,2.63395714854843,-7,2.12620941580635,-7,-7,7,7,7,-7,7,-0.0178461505043517,-7,7,-7,-7,0.8219723280298,-7,-7,1.02789132684023,-7,-0.595866146925642,-0.843045723090291,-7,0.837951516827979,-7,-7,-7,-7,-2.02646633065708,-0.172160659727309,-7,-0.0405668363860659,7,-0.0404070977060737,4.13477351104869,7,3.75589983807562,0.946736690064383,0.634059435347189,0.179323201149133,-1.68558516606702,-7,-7,-7,-7,-7,-7,-0.559256609275393,-7,-7,-7,-1.94261547342414,-7,-7,-7,-2.93846947170583,2.23883018392626,7,0.530654113185563,-7,1.92469760626101,-7,-7,-7,-0.213376203687272,7,-7,-7,-7,-7,-7,-1.6905953902407,1.18224926854708,-0.76649700360943,-0.900982249721609,0.29031230184648,0.268718381485494,-7,1.14854828646909,-0.358036699550296,-7,-7,-0.593084618364854,-7,-1.56440342002405,-7,-7,-1.87110029943083,-7,-7,-7,-7,-0.967803110398651,-7,-7,0.879755201159504,-7,-7,0.475058376355661,-0.709916088230249,-7,7,-7,0.833820274988706,1.68972668002533,-7,-7,1.19770641960142,-7,-0.898240311650411,-0.0299506091606302,0.151032465270865,-7,-7,7,5.86849668856283,-2.85995795029685,0.680720971583843,1.35795810574484,-7,2.23883018392626,-0.0565214950453998,-7,3.00349763565339,-7,2.33237536343018,7,-7,-7,-7,7,7,-1.38135856831236,-7,2.09262107904702,0.275711599307013,-0.0118221268966886,-7,-7,-7,-7,-7,-7,0.627799479732525,-7,-7,-7,-7,-1.13969022970109,-7,-7,-7,-7,0.033828676297184,-0.466981886605607,-0.136743637642278,-7,-7,7,-7,-1.89853594609576,-0.735992304000804,-7,-7,-1.10301146054876,7,-7,-7,-7,-7,-7,-1.60854090361876,-7,-0.0333362867418515,-0.441357997070788,-7,3.33237536343018,-7,7,-7,-7,-7,-7,-1.50258542062719,2.3068404974133,-0.763668822059728,0.653867683205102,0.630734614857313,-7,-7,-7,2.275794448051,3.30436226813725,-7,0.303924736308312,-7,7,-7,-7,-7,-1.20279116991423,-7,-3.29839602516317,-7,-2.60928558395588,-0.654194777531271,-1.07496346820613,-1.25847637832603,2.18224926854708,-1.79266465749646,0.255534560013,-2.8466886998232,-7,-7,-7,-7,-0.466785815231329,-0.139608664303339,-1.35730753006376,-7,0.707176944176662,-1.43099585928245,-7,-2.18007152812421,-7,-7,-7,-7,1.19348366750039,-7,-1.28601621132942,7,2.3068404974133,-0.174942607893251,-7,-1.27582030372962,-7,7,3.30436226813725,4.23020832211246,2.70232640567062,2.31955143711812,-7,7,-0.0252738532149822,-7,-7,2.12409449591179,1.59335350660567,-7,7,7,-7,2.11561661390672,2.22205148758664,1.2377366465501,-7,0.774163507401099,7,-7,-7,0.711660179026993,7,-7,-7,-7,-1.46478942301353,-7,-7,0.745697474326241,-7,-7,1.26297052173894,-7,-0.153776557492376,-7,0.901688777839449,-1.24193896995851,-7,-7,-7,-7,1.28484471602836,-1.43817181991614,-7,7,1.4558802322599,-7,-7,-0.669836675385563,0.90676199042461,-1.0532296065709,-7,0.581543110274726,-7,4.02535976367579,-7,-7,-7,7,2.19940885479308,-7,-7,-7,1.27243461716428,-7,-7,1.2158537017851,7,-7,-7,7,-7,1.18583704874882,0.979904423693664,-7,0.155287764399373,-7,-7,-1.04708405479855,-7,-7,-7,3.81230460920736,-7,-7,0.29401059859755,0.447426313167228,7,-7,-7,7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-7,-0.368385489245301,-7,-7,-7,-7)

# Vector of log2 fold change values, moderated by variance stabilization
mod_lfc = c(0.38513250202834,-4.53641699649679,-1.10076771636501,1.1421066316562,0.236415443896913,0.36768714191439,1.44160949410799,1.11726725015366,-0.837590192859786,0.131441793030244,0.364447606210926,0.38513250202834,1.37605867623786,0.731525508139558,-1.11954127222309,-1.21715694998046,-1.43379915113078,1.42412470192358,-0.733080574450623,0.531548781939233,0.364447606210926,0.376423801433206,-1.9249173551901,-0.0452989062938078,1.49444129059856,1.35595671612,0.376423801433206,-1.95727246535745,0.376423801433206,-2.32320189317671,0.744110943347596,0.38513250202834,-1.11954127222309,-1.11954127222309,-1.49390729096758,1.11726725015366,-4.46265254262642,0.0664096432039352,0.510158898765932,-1.11954127222309,0.376423801433206,1.2597390070052,-0.615479258917462,0.531548781939233,2.44532608111711,-0.934617575074467,0.376423801433206,0.696720571368583,0.781902373269633,0.38513250202834,-0.933863010208414,0.740871407644132,0.38513250202834,0.38513250202834,0.364447606210926,1.66166793833016,0.225125636793827,0.38513250202834,0.263032740704208,-1.47043044410817,1.15094359229443,-4.74450015094185,-1.11954127222309,-3.93446563071909,-1.10781245556378,-0.556379553689585,0.287516930025336,1.41171664872953,3.2864551450446,0.740871407644132,0.364447606210926,0.891297357649886,0.364447606210926,0.36768714191439,0.474112508733351,0.364447606210926,0.38513250202834,0.38513250202834,2.34233386435062,0.36768714191439,0.740871407644132,0.531548781939233,2.62380863310125,-0.743117470789884,-1.10076771636501,-0.468819983474748,0.36768714191439,-1.44439615998094,0.531548781939233,0.364447606210926,0.376423801433206,0.043537390216239,-8.47347008664932,0.36768714191439,0.364447606210926,2.42740143024693,0.364447606210926,0.36768714191439,1.91105967654874,-0.579874907240088,0.871585469180131,1.04619628978427,0.239223465597323,-0.332303013265514,0.38513250202834,-0.339211412903467,0.398989160866312,0.36768714191439,0.376423801433206,0.777365010905502,0.364447606210926,1.08565040255975,0.999634874804654,1.12600390967247,1.92977382303616,0.895291400794272,0.36768714191439,0.36768714191439,0.376423801433206,1.0669396055834,0.36768714191439,0.376423801433206,-0.80341979131302,0.376423801433206,1.8787967974641,-0.579104164549712,0.852811913322053,0.749580108239266,-1.11954127222309,0.36768714191439,-1.02354269545308,-1.62110796055786,0.36768714191439,0.36768714191439,-1.36003305131572,0.732134748125315,0.98060121933144,0.0911316951260961,-0.124567072735077,0.364447606210926,1.15138356756093,-1.11954127222309,-4.09496540071203,3.06162975756124,-0.477852814095733,-0.874900845308554,1.12600390967247,-0.743117470789884,-0.105508184973551,0.364447606210926,-2.23725212075995,0.38513250202834,-0.755093666012165,-2.96433773507576,0.376423801433206,0.97210741611725,0.732134748125315,-1.47043044410817,-1.10076771636501,1.78959341346847,0.38513250202834,-1.40409192106329,-0.161512614110851,-0.0483046199883876,0.744110943347596,0.376423801433206,0.752819643942729,0.36768714191439,0.970824214091663,0.376423801433206,-0.215427301029162,1.27171520222748,0.364447606210926,0.38513250202834,1.10855854955852,1.41930891551974,2.90623464839115,1.95270546691512,0.376423801433206,0.376423801433206,-0.0386501278422005,0.602181160801865,0.135709524298958,1.76050035192151,0.761556303461546,-1.10076771636501,0.376423801433206,2.30277170620842,0.801970389581062,0.520892809124925,1.12924344537594,1.33782092357553,-1.10076771636501,1.11726725015366,0.38513250202834,1.04170768070517,0.38513250202834,0.38513250202834,1.97248527968275,0.38513250202834,0.23387463396386,0.526084924548758,3.50987357367649,-1.12945968475666,0.376423801433206,-1.10076771636501,1.12600390967247,0.364447606210926,0.364447606210926,0.506164855621546,1.27405654724908,-0.751854130308701,0.763843159176097,-0.49970648660139,-0.220305348369468,0.364447606210926,1.49369105158686,0.364447606210926,-0.736320110154087,-1.85586138237718,0.891297357649886,-0.345231040555605,1.11726725015366,-1.10076771636501,1.06514626060432,0.752819643942729,0.364447606210926,1.57192169581145,2.70574984331587,3.01043035858588,2.75990837703744,2.34799496527591,1.58384436775604,0.885505151511782,1.11842154367211,-0.724343914931807,1.83076359443769,-0.132019344687001,3.23334328431567,2.45834572264675,3.84881628580788,1.25027579896914,0.744110943347596,0.551747397215506,0.106446649980851,1.59454746423806,3.78064121602819,-0.0109827226645691,0.868108687954838,0.885340415335851,2.25882302528133,0.364447606210926,0.761556303461546,0.376423801433206,1.25027579896914,-0.351187608125747,0.740871407644132,1.43950726023554,-1.11954127222309,-0.751854130308701,0.137918349132152,1.2597390070052,1.32891009757386,0.744110943347596,-1.11954127222309,-1.85586138237718,-2.97462200177164,-2.0897312300989,-0.761772542842267,0.38513250202834,-1.10076771636501,-0.761760244018959,0.376423801433206,0.364447606210926,-2.33827376516073,-1.56676546685477,2.06876534545164,-1.11954127222309,-1.10076771636501,0.38513250202834,-0.715635214336673,-1.47072888034884,-0.885430670783624,0.376423801433206,-0.732989686851353,-1.11954127222309,0.36768714191439,0.364447606210926,-0.676463469476041,-1.11954127222309,1.27565972528683,1.04018812352204,0.752819643942729,1.59471382413929,0.740871407644132,0.364447606210926,-0.883037891282926,0.376423801433206,0.38513250202834,-0.368632968239697,0.36768714191439,0.137603238275395,0.906025311153265,-0.745144203448978,1.53254270411807,0.510158898765932,2.05607243481384,0.36768714191439,1.03771363756078,-0.378669864578959,1.90358896679098,0.891297357649886,-1.11954127222309,-1.21861633109474,0.740871407644132,0.364447606210926,0.468300499958921,-0.582148929309523,0.915062960953152,0.376423801433206,0.567491981257215,1.41813148213837,-2.92749580330271,1.6361628084384,0.36768714191439,0.38513250202834,-3.42297306921308,-1.69191754549239,0.38513250202834,0.38513250202834,0.740871407644132,-0.375430328875495,0.38513250202834,0.364447606210926,-0.356656773017417,-1.10076771636501,0.36768714191439,0.38513250202834,-1.11954127222309,0.376423801433206,0.102739658415837,-0.85941142158244,0.376423801433206,-0.193126725081362,0.749580108239266,0.874606504976858,0.967660816587022,1.63540830099748,0.364447606210926,0.376423801433206,-3.43683423137499,0.36768714191439,0.36768714191439,-0.346751944528758,0.0961660146669461,-1.49390729096758,0.873851997535936,0.873851997535936,-1.49390729096758,0.520892809124925,0.36768714191439,0.38513250202834,1.41413743899399,0.36768714191439,0.364447606210926,0.38513250202834,0.36768714191439,2.19952069777705,3.78713855668371,3.29401248987662,0.408394666965526,2.60020166747163,3.36117394534895,1.27242018958336,0.376423801433206)

# Boolean vector indicating whether lfc is finite or not
finite = c(FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE)

# Vector of colors
colors = c('#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#7272D8','#BEBEBE','#9898CB','#7272D8','#BEBEBE','#9898CB','#7272D8','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#9898CB','#9898CB','#9898CB','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/htseq/figures/DESeq/htseq_all_individuals_cutoff-0_LNCaP-PrEC_log2FoldChange-vs-ModeratedLogRatio.pdf')

# Plot of normalized mean versus log2FoldChange
plot(lfc, mod_lfc, pch=20, cex=.4, asp=1, 
						col=ifelse(finite,colors,"purple"),
						main="Direct (lfc) vs Moderated log ratios (mod_lfc)",
						sub="purple were infinite in lfc, arbitrarily set for plotting")
					abline(a=0, b=1, col="#40C04040")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
