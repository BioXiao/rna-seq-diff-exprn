#/usr/bin/Rscript
# This script plots a histogram showing the distribution of p-values.
# Ideally, a p-value histogram would be flat (uniform distribution), with equal probability of every value.

# Vector of p-values
pval = c(0.399867774441836,6.58446905844443e-05,0.0492718236228125,0.877547121750554,1,1,0.120129502558262,1,0.15258823854037,1,1,1,0.801402427905104,2.58583588509404e-09,0.866030654645098,0.399867774441836,0.0336567490007447,0.761131198522125,0.636188536674608,1,1,1,0.00504640365188838,0.947222018347,0.662404837054075,0.0491837324226339,1,0.0215572068068769,1,0.399867774441836,0.399867774441836,0.217257505657888,0.864422882416851,1.85198046834087e-06,1,1,0.399867774441836,1,0.942498811472308,0.600055180678367,1,0.233530985738232,0.373337967210829,1,0.501231495068164,0.300726158667379,0.0718817975816486,1,1,1,1,0.380487928743619,1,1,1,1,0.988250862114002,0.00307664546938786,1,2.75832166477688e-25,0.399867774441836,1.18468699124977e-13,0.00773959502215984,1,0.274908189092063,1,1,1,1,1,1,1,1,1,0.0744348281285092,1,1,1,1,0.0294023420043984,0.648154189281342,0.38242449644748,1,1,0.125439951275587,1,1,1,1,1,1.54120411514523e-22,1,0.0170270611385286,0.213604492383498,1,1,0.0164726159227331,0.947886950641238,1,1,0.600257567766153,0.394887435060127,1,0.864168334923591,1,1,1,0.46620278618869,0.861145339845029,0.864422882416851,1,1,0.0135282128669942,0.38242449644748,1,1,1,0.947079794901008,1,1,0.700370119211549,0.864168334923591,0.555502274659325,0.31086635299684,1,1,0.281748524288477,1,0.022950072139834,0.0489667254355727,1,1,0.00397410528964501,1,0.538448076788447,0.94645094873668,1,0.841721635010484,1,0.864043151589255,0.399867774441836,0.0170923774013638,0.195492233694008,0.188551611082374,1,0.648154189281342,1,1,0.0890602877154146,1,0.647130787953405,0.00244852236987179,0.789528149388686,1,0.000106482789847907,0.205136339614047,0.38242449644748,0.399867774441836,0.343596507670867,0.183561722251576,0.708199095501469,1,1,1,1,1,1,1,0.94287768927702,1,1,0.133163925219586,0.649863545687697,1,0.0122289924856145,0.0853614887251883,0.94721362608409,1,0.38242449644748,1,0.899227093536964,1,0.999991794297366,0.772378244694329,1,0.465503640070575,0.864168334923591,0.000704307567088181,0.309886026974742,0.942956025130935,0.013905012387931,0.0159724244611424,1,1,0.38242449644748,0.399867774441836,1,1,1,0.952457449777429,1,1,0.217848242611178,1,1,1,0.48087682566298,0.0112327723348045,0.427692582101159,0.38242449644748,1,1,1,1,1,1,0.377013412677276,1,1,1,0.942586978909433,1,0.166114573442392,1,0.339205146262598,0.370690828398707,0.863744082599215,1,0.38242449644748,0.97120389409592,1,1,0.475175614440568,1,0.11985803230039,0.00721008457082575,0.159227283342754,0.0793618561743317,0.668241419482287,0.357870673453559,0.240959118214317,0.958260199998297,0.636456337559777,0.0113272861177331,1,0.00210071788959198,0.0261882846772298,0.0222902115367131,0.290471582476632,0.929573908577846,0.0068502620040796,1,0.687406230280207,0.00297966050755941,0.391794199962942,1,1,0.382580792814922,1,0.864000712572867,1,0.0172521823028736,0.647130787953405,0.864569528663869,1,0.942498811472308,0.0539355860571438,1,0.427747181818537,0.38242449644748,1,1,1,0.0333835336600931,1,0.17807516148104,0.00490591418076571,0.94978980428779,0.0022423323623493,0.31286279132598,0.689358346253596,0.698803141918277,0.00967664201623046,0.789647426275332,1,1,0.0829750689683721,1,1,0.864569528663869,1,0.442825192740328,1,0.601432371971119,0.789600179808658,1,1,0.370759160174173,0.329293789641459,1,1,1,0.933014503931161,0.217257505657888,1,1,1,0.789685544742436,1,0.00420199958582747,0.166898695969709,0.0186016952422023,0.943181434471264)

# The expression_common.R file sources the DESeq_utils.R file that has the plotting functions we need
source('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/expression_common.R')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/htseq/figures/DESeq/htseq_max_individuals_cutoff-0_LNCaP-PrEC_pval.pdf')

# Plot a histogram of the unadjusted p-values
pValHist(pval, "LNCaP vs PrEC 
unadjusted p-values")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
