#/usr/bin/Rscript
# This script plots a histogram showing the distribution of p-values.
# Ideally, a p-value histogram would be flat (uniform distribution), with equal probability of every value.

# Vector of p-values
pval = c(1,0.129242954476891,0.793246485896785,0.837337905967796,1,1,0.216638864405576,1,0.564863809168125,1,1,1,0.837337905967796,0.992523242036766,0.778313394473797,0.402377462985702,0.235315636106243,0.703517498358137,0.930697155457772,1,1,1,0.158885078718659,0.963911961757211,0.703517499864822,0.862438182975499,1,0.415324401615071,1,0.258771685640345,1,1,0.778313394473797,0.778313394473797,0.662199483130099,1,0.00868726052883041,1,1,0.778313394473797,1,0.996613120995435,0.869118670163186,1,0.361573437475774,0.680606745317162,1,0.566300212163276,0.40432829061058,1,0.455526386967615,1,1,1,1,0.438978329794894,0.999625166662374,1,0.926367107194611,0.676127526801261,1,0.000397733282366869,0.778313394473797,0.00477640799801646,0.235694232610412,0.690696159742016,1,0.622141691788132,0.0780340668429109,1,1,1,1,1,1,1,1,1,0.171716591933159,1,1,1,0.086640124962903,0.919656786414296,0.793246485896785,1,1,0.416545872738348,1,1,1,1,0.00167227885649726,1,1,0.422124862136749,1,1,0.0767838322006662,1,1,0.965970800219056,1,0.980335864872694,1,1,1,1,1,1,1,0.65382900639768,0.996613120358552,1,0.0688129705480834,1,1,1,1,0.972779753072728,1,1,0.934839815108638,1,0.615002511711808,0.720732584204032,1,1,0.778313394473797,1,0.366764830966714,0.282507429733408,1,1,0.212578367449275,1,0.955539554611282,0.924230307521971,1,1,0.837337906228607,0.778313394473797,0.0117509861918228,0.00362385294811132,0.926643132968849,0.631492480702015,1,0.919656786414296,1,1,0.446664026584234,1,0.892278657019435,0.12225963143329,1,0.996613120318142,1,0.676127526801261,0.793246485896785,0.444222612951067,1,0.535572937190061,0.910286905004572,0.991879644768247,1,1,1,1,0.996613120358552,1,1,0.996613120318142,1,1,1,0.0718013917015826,0.19350356806478,0.521316941914115,1,1,1,0.756064291226908,0.867418748939985,0.521316941914115,1,0.793246485896785,1,0.0641126741896602,0.426079109220688,1,1,0.0715323571316085,0.793246485896785,1,1,0.996613120995435,1,1,0.324915728866601,1,0.984671427671622,0.533293036104337,0.0418976408536641,0.714819746500869,1,0.793246485896785,1,1,1,1,0.704027530229457,0.919656786414296,0.468357923743489,1,1,1,0.996613120995435,1,0.909497889924502,0.469669829416178,1,0.800912024186909,1,0.793246485896785,1,1,1,0.554842587291269,0.243183609915411,0.0377439978892305,0.168767231370772,0.167836508593369,0.816046401142114,0.465058971386259,0.361738005196631,0.930697155457772,0.0633913314033578,1,0.0213650860628608,0.289049084987025,0.0185414066643018,0.996613120995435,1,0.385183770290228,0.770617402619827,0.0668556797311059,0.0203580293480459,1,0.750711924740458,1,0.0279224059615182,1,1,1,0.996613120995435,1,1,0.0800865099601332,0.778313394473797,0.919656786414296,0.95135580925526,0.996613120995435,0.15784464375188,1,0.778313394473797,0.469669829416178,0.271039196981953,0.279560644094669,0.771223759411477,1,0.793246485896785,1,1,1,0.145017017503704,0.240999034202492,0.539514692999647,0.778313394473797,0.793246485896785,1,0.909497889924502,0.605681000464684,0.621728414478348,1,0.603852987262829,0.778313394473797,1,1,0.636348437843407,0.778313394473797,0.996613120995435,0.750262362334409,1,0.083027661723009,1,1,0.370178876529999,1,1,1,1,0.848645969360059,1,0.648953927609817,0.0444357949003129,1,0.664942003883477,1,1,1,0.0423805954598355,1,0.778313394473797,0.621661292960592,1,1,0.69149046584309,0.925849595863167,0.495817117519673,1,0.851882078208798,0.837337906228607,0.0645230326244523,0.837337906228607,1,1,0.0456496024659051,0.344542433660273,1,1,1,1,1,1,1,0.793246485896785,1,1,0.778313394473797,1,0.754892424492031,0.670851770778299,1,1,1,1,0.421617996277674,0.837337905967796,1,1,0.00825767642847738,1,1,0.862213662876765,1,0.662199483130099,1,1,0.662199483130099,1,1,1,0.862438182975499,1,1,1,1,0.444936563539014,0.0592334502214505,0.0730241007408138,1,0.289049084987025,0.0622879459134139,0.996613120358552,1)

# The expression_common.R file sources the DESeq_utils.R file that has the plotting functions we need
source('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/expression_common.R')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/htseq/figures/DESeq/htseq_all_groups_cutoff-0_LNCaP_group-PrEC_group_pval.pdf')

# Plot a histogram of the unadjusted p-values
pValHist(pval, "LNCaP_group vs PrEC_group 
unadjusted p-values")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
