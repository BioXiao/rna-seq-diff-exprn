#/usr/bin/Rscript
# This script plots a histogram showing the distribution of p-values.
# Ideally, a p-value histogram would be flat (uniform distribution), with equal probability of every value.

# Vector of p-values
pval = c(0.771439182983556,0.104623245342852,0.224589211057304,0.885569932943957,1,1,0.242330909568538,1,0.461566528527967,1,1,1,0.885569932943957,0.00448324979839574,0.948983497888895,0.771439182983556,0.227118579761294,0.752421916512059,0.902425541112363,1,1,1,0.110415805231945,1,0.885569932454681,0.370936374514744,1,0.260630149825117,1,0.771439182983556,0.771439182983556,0.657146978264735,1,0.0087081712016103,1,1,0.771439182983556,1,1,0.788932134369139,1,0.396149680172444,0.588421968856694,1,0.658697535087185,0.47581771627935,0.359337032665979,1,1,1,1,0.500025355419939,1,1,1,1,1,0.0995709346954138,1,0.000223863929941198,0.771439182983556,0.00167621327681743,0.189607036002736,1,0.517642188778032,1,1,1,1,1,1,1,1,1,0.188457657908582,1,1,1,1,0.0931654776095652,0.903861588550326,0.769584050495108,1,1,0.359596285889799,1,1,1,1,1,0.00220569767084868,1,0.177984828235173,0.411308646986917,1,1,0.097017020449606,1,1,1,0.849513741997663,0.54811797082027,1,0.99910385905711,1,1,1,0.586382523016909,1,0.881880812443911,1,1,0.0846173666920751,0.769584050495108,1,1,1,1,1,1,0.87714153073058,0.87979943164489,0.659480575064187,0.606144602268543,1,1,0.59790918535782,1,0.278848150661568,0.21622412356491,1,1,0.157283685213193,1,0.76478559364399,1,1,0.957121228567511,1,0.885569933121495,0.771439182983556,0.145960533079708,0.500608982302913,0.580608610386533,1,0.903861588550326,1,1,0.444833620811243,1,0.881880812443911,0.0930871638440576,1,1,0.02957266504138,0.655437782042614,0.769584050495108,0.771439182983556,0.486328796313833,0.526431073715644,0.836073949004635,1,1,1,1,1,1,1,1,1,1,0.547448497998195,0.881880812443911,1,0.110833964044295,0.218881969948038,1,1,0.769584050495108,1,0.799684015782004,1,1,0.849075894256847,0.986322671164347,0.57013570595164,0.87979943164489,0.0609670242894929,0.504730889315953,1,0.11202807664766,0.110627349061929,1,1,0.769584050495108,0.771439182983556,1,1,1,1,1,1,0.354424333596295,1,1,1,0.6449888926456,0.0459208236480334,0.70727109406953,0.769584050495108,1,1,1,1,1,1,0.546165804944222,1,1,1,1,1,0.429397830612779,1,0.570791890311548,0.661030649125307,0.99910385905711,1,0.769584050495108,1,1,1,0.607563990309138,1,0.270243323448667,0.0413306344573981,0.192548681647654,0.181458419872742,0.898888770590627,0.513942770006279,0.402893198684108,0.964906184008241,0.902425541112363,0.0813947052372958,1,0.0256292620053925,0.0837169148726199,0.0851536981991467,0.52036876158589,0.913646996724866,0.0716415342636822,1,0.811989333773924,0.0367063525199303,0.68218717881194,1,1,0.472502221227993,1,1,1,0.113924656923966,0.881880812443911,0.903861588550326,1,1,0.198099829016786,1,0.759516025000566,0.769584050495108,1,1,1,0.295297592212676,1,0.578999501860227,0.0728053835232918,1,0.0487270463675279,0.553936310811833,0.763352098725392,0.823992091583591,0.0403633036260702,0.885569933121495,1,1,0.279183316615791,1,1,1,1,0.720085997317959,1,0.83809055998711,0.885569932943957,1,1,0.703865440989237,0.486824940046286,1,1,1,1,0.657146978264735,1,1,1,0.885569932454681,1,0.0481835174231502,0.319465397456415,0.0697292339582795,1)

# The expression_common.R file sources the DESeq_utils.R file that has the plotting functions we need
source('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/expression_common.R')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/htseq/figures/DESeq/htseq_max_groups_cutoff-0_LNCaP_group-PrEC_group_pval.pdf')

# Plot a histogram of the unadjusted p-values
pValHist(pval, "LNCaP_group vs PrEC_group 
unadjusted p-values")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
