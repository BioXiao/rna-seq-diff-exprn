#/usr/bin/Rscript
# This script plots the direct log fold change (lfc, x-axis) versus the moderated log-ratios (mod_lfc, y-axis).
# [From DESeq documentation] 'The moderation criterion used is variance stabilization.
# The points are colored in a scale from gray to blue, representing weakly to strongly expressed genes.
# The purple points correspond to values that were infinite in lfc and were arbitrarily set to +/- 7 for the purpose of plotting.'

# Vector of log2 fold change values
lfc = c(7,4.33424036835731,2.724699629304,-7,0.0346282164727159,-7,-1.78883257181633,-7,0.843223732646393,-0.111401193880057,-7,-7,-7,3.8529728976362,0.42555943904335,7,1.32797946871975,-7,2.23222476910614,-7,-7,-7,2.12832991782771,-0.511420130538207,-7,2.66612281710228,-7,2.17545006685623,-7,7,7,7,1.36726460367368,4.27874667366318,0.0103537110586463,-7,7,-7,-7,0.868525605015721,-7,-7,1.05917026817694,-7,-0.5759251610799,-0.809757936591074,0.86994369534407,-0.133872618290471,-7,-7,-7,-2.01913500788694,-7,-0.149396886951799,-7,-7,-0.0168738419721783,2.17024688435004,-0.0298638662260278,4.17403938796849,7,3.78637857674674,0.979601368240723,0.195198003512805,-1.41535800769479,-7,-7,-7,-7,-7,-0.486655529807182,-7,-7,-7,-1.87492612156512,-7,-7,-7,-7,-2.93386207666321,2.33098964251498,7,0.530654113185563,-7,1.93810484442074,-7,-7,-7,-7,-0.169542457719932,7,-7,1.63571290470454,-7,-7,-7,-1.63605617847549,-0.935999416076888,0.109091153115124,0.362176269527761,0.309364654584313,-1.02399302071018,-7,1.16503014752799,-0.300001816352033,-7,-7,-7,-0.655536330413111,1.36726460367368,-7,-7,-1.81759075922373,7,-7,-7,-7,-0.957409189913581,-7,-7,0.925723751160731,1.16503014752799,-7,0.51510334207845,-0.64904956328569,-7,1.2935906241849,-7,0.869989136834153,1.72269152987211,-7,-7,1.23978167570795,-7,1.80010497537056,-0.828432325145012,0.0182601113891394,0.195522062732651,-7,-7,7,-1.24231113102969,0.820393407739352,1.37672106012369,-7,2.33098964251498,-0.0280201966661807,-7,3.06285965756304,-7,2.40447523531685,7,-7,-7,7,7,7,7,-1.3752186621319,2.14953257978099,0.322472249528969,0.022198703100275,-7,-7,-7,-7,-7,0.655315526023497,-7,-7,-7,0.736852989554083,2.23040991205511,-7,-1.11174425994679,-7,-0.953871722677334,-7,7,-7,-7,-7,0.08108491660375,-0.44778255667468,-0.104499959645596,-7,1.16503014752799,-1.87906422632682,-0.693109495264048,-7,-1.06783889549755,-1.43332672623571,-7,-7,7,7,-7,-7,-7,-7,-7,-7,-1.60467109489763,-7,-7,-0.0134844713263319,-0.397461928537199,-7,2.36726460367368,7,-7,-7,-7,-7,-7,-0.423970499261301,-0.733137048850998,-7,-0.285687964458298,-7,-7,-7,3.3482200286633,-7,1.00799704137099,0.345392377782131,1.26066733392408,-7,7,-7,-7,-7,-1.18989375928419,-7,-7,-3.28940508681032,-7,-2.60039238057934,-0.648812806150504,-1.03525320918173,-1.2079689938318,-0.117931769124248,2.21619634436659,-1.76095829569484,0.334980084941841,-2.83726590326511,-7,-3.00158768686856,-0.431063594977011,-0.0999667741704738,-1.32669588846527,0.775521637708461,-1.52500267825229,-2.15652341352762,-7,-7,-7,-1.02947755791726,-7,1.2000256807963,-7,-1.24768065713695,2.40447523531685,1.33898159540934,-0.153169241128261,-7,-1.23091194021376,-7,2.37546063207248,7,-7,-7,-7,0.784404591313616,-7,0.92474133013266,-1.211962046713,-7,-1.4145485361228,1.49863893292445,-0.626871612925377,0.656201381467879,2.47154445608368,-7,-7,-7,2.24095989718554,-7,-7,1.33898159540934,-7,1.20347959885642,-7,0.191721520913957,-7,-7,-7,0.323497329716362,-7,-7,-7,-7,0.455068634687565,7,-7,-7,-7,-7,-7,-7,-7,-7,-7)

# Vector of log2 fold change values, moderated by variance stabilization
mod_lfc = c(-1.15032727224682,-3.57896825870143,-2.1708001692216,1.15667160932328,0.213061375565435,0.370177863343275,1.48819418727882,1.11836389512601,-0.910686588102152,0.106352846010078,0.362923660788565,0.385262370994166,1.3832875664946,-3.61711670145673,0.685464341776423,-1.15032727224682,-1.50841210424888,1.43112427583784,-0.739826655684017,0.535216443091551,0.362923660788565,0.372222471299957,-2.05124321769162,-0.0500330562440241,1.73561111911221,-2.03041329896819,0.372222471299957,-2.24404159653469,0.385262370994166,-1.15032727224682,-1.15032727224682,-1.54999994996593,-0.415181140158299,-3.50437840328742,0.0416019992285972,0.515784377471914,-1.15032727224682,0.372222471299957,1.26397040925465,-0.668768489023805,0.535216443091551,2.47170231580229,-1.0030286322281,0.372222471299957,0.693425671254509,0.779013916983295,-1.00080707123728,-0.401297956338863,0.385262370994166,0.385262370994166,0.362923660788565,1.69831736223931,0.891664140710028,0.21009135431975,0.385262370994166,0.362923660788565,0.227645689712175,-2.47017254946929,1.15792081853284,-4.82224942094586,-1.15032727224682,-4.10006160727941,-1.07297878185149,0.269473264905484,1.14742124204294,0.735146132088522,0.362923660788565,0.891664140710028,0.362923660788565,0.370177863343275,0.454559762601082,0.362923660788565,0.385262370994166,0.385262370994166,2.38075276063126,0.370177863343275,0.735146132088522,0.735146132088522,0.535216443091551,2.70397975783486,-0.778104800946864,-1.11000451902729,-0.469117287175926,0.370177863343275,-1.5115670253968,0.535216443091551,0.362923660788565,0.362923660788565,0.372222471299957,0.0235407182260086,-8.60933518554747,0.73310152413184,-1.68064287668521,2.45642682217432,0.362923660788565,0.370177863343275,1.95299082483567,1.02030538067185,-0.0829581759685549,0.195425361835218,-0.384951350592198,0.934667655158484,0.385262370994166,-0.352519676733168,0.378566808376416,0.370177863343275,0.372222471299957,2.0758269715466,0.349015825613164,-0.415181140158299,1.01106509519464,1.12040850308269,1.97689638271488,-1.11000451902729,0.901046748466081,0.370177863343275,0.372222471299957,1.06909059210645,0.370177863343275,0.372222471299957,-0.843767306126719,-0.352519676733168,1.8855651912096,-0.63855320065242,0.833780717485004,0.748186031782732,-0.955037015410026,0.370177863343275,-1.06435733417027,-1.72870752892837,0.370177863343275,0.370177863343275,-1.42021911340236,0.73310152413184,-0.673420316906789,0.962215356649888,0.0522477018417504,-0.169169310458387,0.362923660788565,1.15690896394597,-1.15032727224682,1.44069457303963,-0.802234260092098,-0.945060609210555,1.12040850308269,-0.778104800946864,-0.125467161270585,0.362923660788565,-2.366483029593,0.385262370994166,-0.787403611458256,-3.04950820748208,1.35382086605141,0.73310152413184,-3.53531537923114,-1.49950825751616,-1.11000451902729,-1.15032727224682,1.8287691139533,-1.50014208220123,-0.202555432110833,-0.0917891190568048,0.742400334643232,0.372222471299957,0.755440234337441,0.370177863343275,0.97812627681809,-0.228656476971449,1.27326921976604,0.370177863343275,0.362923660788565,-0.731778939461009,-0.765064901252655,1.1053239954318,1.3753437795916,2.95607416318087,1.00435812242253,0.372222471299957,-1.11000451902729,0.372222471299957,1.06561404241367,0.755440234337441,-0.0813219834435204,0.606260926233829,0.102183667358764,1.77798634708153,-0.352519676733168,2.32896338420416,0.79398007543285,1.27386461560472,1.28769131341611,1.60722197560228,0.370177863343275,0.385262370994166,-1.11000451902729,-1.15032727224682,0.735146132088522,1.11836389512601,0.385262370994166,1.05100082056347,0.385262370994166,0.362923660788565,2.02077151175245,0.385262370994166,0.385262370994166,0.211476437886299,0.496880172112178,3.58889031862719,-0.814853817877404,-1.11000451902729,1.12040850308269,0.372222471299957,0.362923660788565,0.362923660788565,0.506401769715862,0.138856460574874,0.763831997630132,0.385262370994166,0.376759555042419,0.362923660788565,1.49058636642596,0.362923660788565,-1.89740813048555,0.891664140710028,-0.93011810197276,-0.359150845943375,-0.376902994895451,1.11836389512601,-1.11000451902729,1.07398631218877,0.755440234337441,0.362923660788565,1.59776297077403,0.370177863343275,2.743595806586,3.10654232791451,2.80317732616786,2.41540827276652,1.61266404756492,0.899302689248549,1.14166125024226,0.101791335810371,-0.737782047727334,1.86871699308225,-0.158456888049132,3.33042850565556,3.36436787000247,2.834561600157,0.491529872157119,0.0624136349178421,1.5742045226637,-0.0450032768150239,1.25269058608892,2.32285725317501,2.0720115076892,0.757484842294123,0.372222471299957,0.987003190037502,0.370177863343275,-0.36181848724456,0.735146132088522,1.42746910934606,-0.787403611458256,-0.407926937603589,0.111921728353587,1.26397040925465,1.33763533311837,0.742400334643232,-0.816898425834086,-1.11000451902729,0.385262370994166,0.372222471299957,0.362923660788565,-0.869279024914473,0.372222471299957,-0.808297523986929,1.47653160291429,1.04161821280741,1.87706026437418,-1.27671690249862,0.461755933039446,0.513415111260028,-2.0148889079088,1.6361928805546,0.370177863343275,0.385262370994166,-1.77914563230201,0.385262370994166,0.735146132088522,-0.407926937603589,0.385262370994166,0.0618730244724524,0.372222471299957,-0.231829775509127,1.63406447535326,0.372222471299957,0.362923660788565,-0.383755322135121,2.22003343020963,0.370177863343275,0.370177863343275,0.370177863343275,0.0772225324503197,-1.54999994996593,0.518424381267277,0.370177863343275,0.385262370994166,1.41384068410737,0.385262370994166,3.88011381924963,2.63328189631747,3.43226535885964,1.27036257518007)

# Boolean vector indicating whether lfc is finite or not
finite = c(FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE)

# Vector of colors
colors = c('#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#9898CB','#9898CB','#7272D8','#BEBEBE','#9898CB','#7272D8','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#7272D8','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#7272D8','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#9898CB','#9898CB','#9898CB','#9898CB','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#9898CB','#7272D8','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#9898CB','#7272D8','#BEBEBE','#7272D8','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/htseq/figures/DESeq/htseq_max_individuals_cutoff-0_LNCaP-PrEC_log2FoldChange-vs-ModeratedLogRatio.pdf')

# Plot of normalized mean versus log2FoldChange
plot(lfc, mod_lfc, pch=20, cex=.4, asp=1, 
						col=ifelse(finite,colors,"purple"),
						main="Direct (lfc) vs Moderated log ratios (mod_lfc)",
						sub="purple were infinite in lfc, arbitrarily set for plotting")
					abline(a=0, b=1, col="#40C04040")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
