#/usr/bin/Rscript
# This script plots the direct log fold change (lfc, x-axis) versus the moderated log-ratios (mod_lfc, y-axis).
# [From DESeq documentation] 'The moderation criterion used is variance stabilization.
# The points are colored in a scale from gray to blue, representing weakly to strongly expressed genes.
# The purple points correspond to values that were infinite in lfc and were arbitrarily set to +/- 7 for the purpose of plotting.'

# Vector of log2 fold change values
lfc = c(2.77285507306744,2.64500479547279,1.85880249714431,-7,-0.242935039216876,-7,-1.71930715653208,-7,0.601280935238107,-0.112203824880259,-7,-7,-7,2.27678906999742,0.271156724407552,2.77285507306744,0.953190002906536,-7,1.76698037871971,-7,-7,-7,1.43786706084428,-0.364795544638286,-7,1.96109637445058,-7,1.52321356837146,-7,2.77285507306744,2.77285507306744,2.77285507306744,0.956456079107622,2.44425447200811,-0.0501998843397936,-7,2.77285507306744,-7,-7,0.534962141793182,-7,-7,0.75806195954706,-7,-0.489469006617427,-0.807332444259383,0.685270712293875,-0.198545162011284,-7,-7,-7,-1.69821311453772,-7,-0.221874159189626,-7,-7,-0.0363400887954318,1.41096816040335,-0.0700939419263494,2.35678107401191,2.77285507306744,2.29062801770043,0.76519218056795,0.110478303715471,-1.19651527316534,-7,-7,-7,-7,-7,-0.318338666625736,-7,-7,-7,-1.80832048259479,-7,-7,-7,-7,-2.72083295576022,1.77285507306744,2.76698037871971,0.290331715856215,-7,1.36708980182721,-7,-7,-7,-7,-0.287882154806966,2.77048010159696,-7,1.22116862023198,-7,-7,-7,-1.59121418982865,-0.70395206873642,0.113418641127128,0.241033239327174,0.15938816358514,-0.923565145215173,-7,0.950581384759887,-0.325771642672401,-7,-7,-7,-0.368406372715819,1.43828109295057,-7,-7,-1.74822149486941,2.76698037871971,-7,-7,-7,-0.828528042414892,-7,-7,0.671294000391521,1.43240639860283,-7,0.424465894140446,-0.698077374388685,-7,0.907034229712004,-7,0.66109487696326,1.30546137182663,-7,-7,0.931595119451851,-7,1.43828109295057,-0.942166250078497,-0.0409089339774541,0.144427110399378,-7,-7,2.77285507306744,-1.11663327346548,0.576649840420686,1.03610082888724,-7,1.77285507306744,-0.0464782778284567,-7,2.00280751646205,-7,1.43828109295057,2.76992071613136,-7,-7,2.77089949840536,2.76698037871971,2.76698037871971,2.77285507306744,-1.22134573413657,1.44104512741602,0.245541395675159,-0.0139606054290611,-7,-7,-7,-7,-7,0.59001620515363,-7,-7,-7,0.573141327846246,1.43828109295057,-7,-1.01362574527927,-7,-0.490939924405906,-7,2.76698037871971,-7,-7,-7,0.00484116217269096,-0.413014016911988,-0.158454678793528,-7,1.43240639860283,-1.77529632737859,-0.67530864561053,-7,-1.00279710034847,-1.32944052234017,-7,-7,2.76698037871971,2.77285507306744,-7,-7,-7,-7,-7,-7,-1.47448419700569,-7,-7,-0.0336210963878135,-0.41618780332858,-7,1.95645607910762,2.76698037871971,-7,-7,-7,-7,-7,-0.2840637827702,-0.713267021075759,-7,-0.0435439208923783,-7,-7,-7,1.95352172217154,-7,0.686897592852231,0.237370929033164,0.950581384759887,-7,2.76698037871971,-7,-7,-7,-1.05167080212827,-7,-7,-3.06495282188174,-7,-2.37314874082076,-0.584582569045509,-0.977137294011259,-1.14723734557428,-0.156092600972823,1.76698037871971,-1.64859226416182,0.450926978180081,-2.61949087311236,-7,-2.76895372739689,-0.386246433550396,-0.157498422056899,-1.26721109930972,0.595890899501365,-1.2448783778646,-2.03175528073345,-7,-7,-7,-0.884268638239864,-7,0.751190266435389,-7,-1.19685378637373,1.43828109295057,1.77285507306744,-0.114162053924305,-7,-1.16859591895338,-7,1.59589089950136,2.76698037871971,-7,-7,-7,0.592903257134617,-7,0.699432047054901,-1.09581777736293,-7,-1.30506578706768,1.0979416960009,-0.701940871811819,0.543674288097045,2.24859106337457,-7,-7,-7,1.51200041300575,-7,-7,1.18789257234629,-7,0.986666789468713,-7,0.112209844325342,-7,-7,-7,0.210857060205847,-7,-7,-7,-7,0.29604793126358,2.77285507306744,-7,-7,-7,-7,-7,-7,-7,-7,-7)

# Vector of log2 fold change values, moderated by variance stabilization
mod_lfc = c(-0.72957023836082,-3.09266126025589,-1.513193262914,1.6282695256053,0.591087811583914,0.445465974081714,1.51020268156437,1.25062150097175,-0.715391580587402,0.130127343584017,0.561381951293859,0.561381951293859,1.6282695256053,-2.91529742706962,0.82637733085558,-0.72957023836082,-1.18480144666403,1.76612402402645,-0.522174106877647,0.805155526890036,0.561381951293859,0.445465974081714,-1.51501210108627,0.188593349378507,1.56087245267495,-1.86813673384285,0.445465974081714,-1.97760162917648,0.561381951293859,-0.72957023836082,-0.72957023836082,-0.941988680672546,0.0370632842845351,-2.57592286735685,0.169793080152054,0.650717545433211,-0.72957023836082,0.445465974081714,1.45587307232325,-0.409242078542665,0.805155526890036,2.44483725852167,-0.658201360407396,0.445465974081714,0.742900591509933,0.883681795464111,-0.888487197334635,0.102050045983916,0.561381951293859,0.561381951293859,0.561381951293859,1.64435709375136,0.977551980172086,0.307380837772623,0.561381951293859,0.561381951293859,0.321927025655142,-1.52297539201707,1.35901517756373,-3.89140629077552,-0.72957023836082,-3.50649124303231,-1.0648937917915,0.662536373019576,1.00849574675513,1.00684792537557,0.561381951293859,0.977551980172086,0.561381951293859,0.445465974081714,0.574044875091823,0.561381951293859,0.561381951293859,0.561381951293859,2.41080095061572,0.445465974081714,1.00684792537557,1.00684792537557,0.805155526890036,2.71947030557532,-0.524318667009324,-0.727425678229143,0.250126301942942,0.445465974081714,-0.970202619430411,0.805155526890036,0.561381951293859,0.561381951293859,0.445465974081714,0.190531504631635,-6.04675567148391,1.00684792537557,-1.36766825115452,2.51264371138366,0.561381951293859,0.445465974081714,2.01207146108504,0.962114638115511,-0.0954412331508605,0.572544890306828,-0.213309345862459,0.91866618923877,0.561381951293859,0.0392078444162123,0.721022156052268,0.445465974081714,0.445465974081714,2.03391286691595,0.276212046213558,-0.168188287066962,1.4230179542538,1.25062150097175,2.04296694385331,-0.727425678229143,1.21209949672707,0.445465974081714,0.445465974081714,1.05059609676323,0.445465974081714,0.445465974081714,-0.451869496258589,-0.166043726935284,1.88360436520261,-0.573053445266661,0.959970077983834,0.805155526890036,-0.62167518664941,0.445465974081714,-0.946759845941273,-1.36014910624858,0.445465974081714,0.445465974081714,-1.25047679242963,1.00684792537557,-0.13683315378251,1.080226163921,0.125891385403338,-0.133658247896365,0.561381951293859,1.60457663058409,-0.72957023836082,1.44626607455559,-0.59842446137728,-0.720885031913166,1.25062150097175,-0.524318667009324,0.0281047160500592,0.561381951293859,-1.8961486497225,0.561381951293859,-0.168188287066962,-2.264150096366,1.36080305498792,1.00684792537557,-2.59210483068089,-0.939232713149745,-0.727425678229143,-0.72957023836082,1.80074767706204,-1.00424005047716,-0.116440830353632,0.0361385031180914,0.650717545433211,0.445465974081714,1.00684792537557,0.445465974081714,1.4230179542538,0.18791140267706,1.36080305498792,0.445465974081714,0.561381951293859,-0.60533530739731,-0.168188287066962,1.21209949672707,1.49997971996038,2.90698598394068,0.824260139694359,0.445465974081714,-0.727425678229143,0.445465974081714,1.79745437754871,1.00684792537557,0.0216782609071515,0.637431742698517,0.212356958718652,1.99715179200522,-0.166043726935284,2.46402788319415,0.837617087670323,1.21209949672707,1.42183677933995,1.68246929786466,0.445465974081714,0.561381951293859,-0.727425678229143,-0.72957023836082,1.00684792537557,1.25062150097175,0.561381951293859,1.45587307232325,0.561381951293859,0.561381951293859,2.03311584623141,0.561381951293859,0.561381951293859,0.281449947115777,0.5691827660727,3.61507182072395,-0.380606729378687,-0.727425678229143,1.25062150097175,0.445465974081714,0.561381951293859,0.561381951293859,0.805155526890036,0.213144262479471,0.848554889987612,0.561381951293859,0.548625702770218,0.561381951293859,1.45587307232325,0.561381951293859,-1.13582836802632,0.977551980172086,-0.629587683539977,-0.31570345478017,0.0392078444162123,1.25062150097175,-0.727425678229143,1.2328868197694,1.00684792537557,0.561381951293859,1.63567869165245,0.445465974081714,2.75856340636764,3.1050632262234,2.98539041425849,2.36976422323929,1.64640486059201,0.974302701776831,1.15379102342793,0.196470008094002,-0.522174106877647,1.9034421006534,-0.155436400609404,3.35024549395482,3.36367872084371,2.76573618986143,0.579890032992742,0.199784456836408,1.70538273343636,0.185766842545383,1.35156347197046,2.39002365725836,2.08109564433739,1.00684792537557,0.445465974081714,1.01601335283796,0.445465974081714,0.0777298486608922,1.00684792537557,1.53572008221589,-0.168188287066962,-0.524318667009324,0.167420874325102,1.45587307232325,1.40066076662738,0.650717545433211,-0.231903171117839,-0.727425678229143,0.561381951293859,0.445465974081714,0.561381951293859,-0.83360603436358,0.445465974081714,-0.62135684537926,1.6166494577013,1.11540647859324,2.03842461686976,-0.768446086411398,0.653866749368541,0.707938705846046,-1.99795384159612,1.60457663058409,0.445465974081714,0.561381951293859,-1.1855046926835,0.561381951293859,1.00684792537557,-0.375615108748476,0.561381951293859,0.339978802343806,0.445465974081714,-0.159913774445476,1.6282695256053,0.445465974081714,0.561381951293859,-0.26633508656281,2.25248663160253,0.445465974081714,0.445465974081714,0.445465974081714,0.545056031843413,-0.941988680672546,0.650717545433211,0.445465974081714,0.561381951293859,1.56087245267495,0.561381951293859,3.89628285920912,2.62381416322398,3.4539534919123,1.4230179542538)

# Boolean vector indicating whether lfc is finite or not
finite = c(TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,TRUE,TRUE,FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,FALSE,FALSE,TRUE,FALSE,FALSE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE,FALSE)

# Vector of colors
colors = c('#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#9898CB','#9898CB','#7272D8','#BEBEBE','#9898CB','#7272D8','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#7272D8','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#7272D8','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#7272D8','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#9898CB','#9898CB','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#9898CB','#9898CB','#7272D8','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#9898CB','#7272D8','#BEBEBE','#7272D8','#9898CB','#9898CB','#9898CB','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#7272D8','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#BEBEBE','#9898CB','#BEBEBE','#9898CB','#BEBEBE')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/htseq/figures/DESeq/htseq_max_groups_cutoff-0_LNCaP_group-PrEC_group_log2FoldChange-vs-ModeratedLogRatio.pdf')

# Plot of normalized mean versus log2FoldChange
plot(lfc, mod_lfc, pch=20, cex=.4, asp=1, 
						col=ifelse(finite,colors,"purple"),
						main="Direct (lfc) vs Moderated log ratios (mod_lfc)",
						sub="purple were infinite in lfc, arbitrarily set for plotting")
					abline(a=0, b=1, col="#40C04040")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
