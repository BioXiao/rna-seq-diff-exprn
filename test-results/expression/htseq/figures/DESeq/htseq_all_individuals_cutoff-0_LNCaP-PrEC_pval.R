#/usr/bin/Rscript
# This script plots a histogram showing the distribution of p-values.
# Ideally, a p-value histogram would be flat (uniform distribution), with equal probability of every value.

# Vector of p-values
pval = c(1,1.42687426008288e-05,0.390879379217489,0.865983955127831,1,1,0.111114482755687,1,0.172282171971168,1,1,1,0.786523547135577,0.886155327238842,0.399392302531311,0.135993935574157,0.0296735840975088,0.749987742398978,0.648608777758426,1,1,1,0.00610527818351704,0.92262660111031,0.640438749103685,0.769208120797136,1,0.0538853757700749,1,0.017576318773714,1,1,0.399392302531311,0.399392302531311,0.215848880100874,1,1.38919535514902e-08,1,1,0.399392302531311,1,0.926820996382928,0.623655008686874,1,0.225376635917369,0.394803573109292,1,0.4620103791397,0.275207310971396,1,0.0840437586371544,1,1,1,1,0.363395322001866,1,1,1,0.209879929820736,1,1.33983398899894e-25,0.399392302531311,1.91929728537144e-13,0.00676680098816566,0.292501351017155,1,0.513187557313216,0.0247001344496104,1,1,1,1,1,1,1,1,1,0.0681063710388743,1,1,1,0.0268722920267905,0.655146792257471,0.390879379217489,1,1,0.135585596997356,1,1,1,1,1.82049364053773e-25,1,1,0.203043784723058,1,1,0.0138745451743414,0.881519158780719,1,0.924534573269531,1,0.651596773430929,1,0.878319973944132,1,1,1,1,1,0.571364498246851,1,1,0.0114665025142069,1,1,1,1,0.924709856872959,1,1,0.719887590436056,1,0.53522763550178,0.346672703643967,1,1,0.399392302531311,1,0.0268706442411414,0.0461388109723383,1,1,0.00409667523614375,1,0.924639418305265,1,0.890652599293879,1,0.853581843093058,0.399392302531311,1.33119208565791e-07,1.32346552554874e-05,0.72239820211882,0.209367168012684,1,0.655146792257471,1,1,0.0841760127053666,1,0.653717072108464,0.00264451438164088,1,1,1,0.209879929820736,0.390879379217489,0.325522011644086,1,0.178702104945366,0.732254002982481,1,1,1,1,1,1,1,1,0.927016454539858,1,1,1,0.00840700008230978,0.0812887520535535,0.448915843114285,1,1,1,0.733849834597379,0.953195116823201,0.448494578945144,1,0.390879379217489,1,0.000494312069619011,0.280831342441236,1,1,0.00949800967953543,0.390879379217489,1,1,0.937822704044072,1,1,0.204344536639501,1,1,0.433567343116787,0.0103886624813005,0.331461549372931,1,0.390879379217489,1,1,1,1,0.660648249993768,0.65407646991762,0.346691587772673,1,1,1,0.926967561151977,1,0.648231476411744,0.168502748000639,1,0.396979438175525,1,0.390879379217489,0.960311140033478,1,1,0.45292982814069,0.114593615673904,0.00637100674167991,0.158465323645473,0.0739759326906848,0.631334269197372,0.337023878368538,0.22385822183356,0.649737440494903,0.00939782582177042,1,0.00175375881284488,0.261081390800624,0.00323138468581586,0.926585807081185,1,0.232590833246777,0.862654540787958,0.00494759092796377,0.0037981976608867,1,0.786547615887156,1,0.00240950369584459,1,1,1,0.926585807081185,0.87820239534202,1,0.0134321900045718,0.399392302531311,0.65407646991762,0.996190172414316,0.926820996382928,0.0459750208216864,1,0.399392302531311,0.168502748000639,0.00403676491792818,0.0538684157940964,0.428355259449281,1,0.390879379217489,1,1,1,0.00377118065983574,0.0201387372995163,0.448708248440051,0.399392302531311,0.390879379217489,1,0.651029180558465,0.298386266009072,0.279169375669676,1,0.217565360987983,0.399392302531311,1,1,0.167197314713721,0.399392302531311,0.927249749545619,0.889114435336213,1,0.0128827598744193,1,1,0.0327792946077109,1,1,0.878052714345214,1,0.906177941091696,1,0.20695572779767,0.0030642266400468,1,0.377140040362024,1,0.936654363398634,0.878282962713637,0.00142337303249999,1,0.399392302531311,0.329052878111189,1,1,0.658957520713271,0.719356646102613,0.371781759948282,1,0.712497406097677,0.769334571132661,0.000605994030666893,0.769276276199185,1,1,0.000128180835138091,0.0902692536235674,1,1,1,0.87831503778492,1,1,0.878157437999264,0.390879379217489,1,1,0.399392302531311,1,0.458949893580332,0.362226221294555,1,0.663733250167163,1,1,0.349929928994823,0.769263832999734,1,1,3.95852004053134e-09,1,1,0.415007780225358,0.952002675576512,0.215848880100874,1,1,0.215848880100874,1,1,1,0.769321018694162,1,1,1,1,0.317510445996818,0.00382136407525544,0.0245917900937099,1,0.160520592850559,0.0173155722627981,0.927212577615874,1)

# The expression_common.R file sources the DESeq_utils.R file that has the plotting functions we need
source('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/expression_common.R')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/htseq/figures/DESeq/htseq_all_individuals_cutoff-0_LNCaP-PrEC_pval.pdf')

# Plot a histogram of the unadjusted p-values
pValHist(pval, "LNCaP vs PrEC 
unadjusted p-values")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
