#/usr/bin/Rscript
# This script plots a histogram showing the distribution of p-values adjusted by the Benjamini-Hochberg correction for controlling False Discovery Rate (FDR). 
#See http://en.wikipedia.org/wiki/False_discovery_rate for more information.
#Ideally, a p-value histogram would be flat (uniform distribution), with equal probability of every value.

# Vector of adjusted p-values
padj = c(0.946746659326874,1,1,1,1,0.654669790000072,0.633643921604946,0.921225427979226,0.00338309063230925,1,0.998117492042344,0.212085331983475,0.0311195681995383,1,0.904336721441984,0.574648118934072,1,0.998117492042344,0.0357169564801642,0.176869920448915,0.720314964256869,0.339680470680681,0.535299620377436,1,0.652910682745596,0.644549446941713,0.715496780549313,0.0447383108802244,1,0.742851699477014,0.318058653262959,0.029222764425636,0.00410352110834274,1,0.577451767779291,0.295370952925634,0.715496780549313,0.857549538428461,1,0.50523719415697,0.49371730131101,0.00506888151792559,0.715496780549313,1,0.231262100972464,1,0.691260003621091,0.652910682745596,0.652910682745596,1,0.526576271342025,0.526377655637847,0.790776259878129,0.482768315379537,1,1,0.479873801272101,0.981852742617899,0.715496780549313,1,0.574648118934072,0.790776259878129,0.715496780549313,1,0.550212452096283,1,1,0.588813744492425,0.588813744492425,1,0.013677361054878,1,0.197296568059436,0.658157931800826,0.025324338050301,1,1,1,0.191935753755119,1,1,0.464029681516332,0.157369603899878,1,0.0383243951930968,1,0.857549538428461,1,1,0.715496780549313,1,0.91594593177492,0.998117492042344,1,1,1,0.822457912315465,0.673507296556022,1,0.485400935461127,1,1,0.228355101598346,0.163686938832541,1,1,1,0.416959015966186,0.574648118934072,0.721607946761764,1,1,0.574648118934072,0.790776259878129,1,1,0.946746659326874,1,0.0786580645700244,1,0.715496780549313,1,1,1,1,1,1,1,1,1,0.588813744492425,0.661248058914455,0.88438219112301,1,1,1,1,0.107262984229418,0.715496780549313,0.172794674081073,1,0.946091199940397,1,1,1,0.000449707916849585,0.644549446941713,1,0.302243883490397,0.0883384034245887,1,0.946746659326874,0.71380155882315,0.633643921604946,0.596830468691586,1,1,1,1,1,0.372702003229956,0.526377655637847,1,4.74875168501043e-07,0.938244247058587,1,0.574648118934072,0.395484060385582,1,1,1,1,0.859547858923506,1,0.339680470680681,1,1,1,1,0.715496780549313,0.673377915889558,1,1,1,1,1,0.224042635671759,1,0.795995477046649,1,0.212085331983475,0.644549446941713,1,1,1,1,1,1,1,0.126560085924191,0.857549538428461,0.673507296556022,0.0198568229677331,0.0209912810621616,1,1,1,0.715496780549313,1,7.54030370017576e-15,1,0.990773076304381,0.613038498098036,1,0.857549538428461,1,1,1,0.980955431392861,1,1,1,1,0.652910682745596,1,0.332620795071695,1,0.652910682745596,1,1,0.590602292890613,1,1,1,1,0.207544790502472,0.591116924210346,1,0.172794674081073,0.477365145597982,1,1,1,0.00263589794024896,1.20891008584523e-05,0.836316246702763,1,1,0.218217812462477,1,1,0.145370112389865,0.623920714568719,0.790776259878129,0.532221155589692,0.444972998032476,0.644549446941713,0.548437946425219,1,0.00410352110834274,1,0.526576271342025,1,1,1,1,0.929118458516262,1,0.88438219112301,0.17633896482951,0.654669790000072,0.715496780549313,1,1,0.929118458516262,0.790776259878129,0.790776259878129,0.400565540475608,0.981590446000771,0.305923885700322,1,0.998117492042344,0.128066694289663,0.992658031035549,1,0.693013848135001,1,0.720314964256869,1,1,0.715496780549313,1,0.191935753755119,1,1,0.790776259878129,0.229593976462674,0.0484567511417072,1,0.644549446941713,1,1,1,0.908586827388853,1,1,0.790776259878129,0.633643921604946,0.633643921604946,0.644549446941713,0.644549446941713,0.790776259878129,0.790776259878129,0.787895137322978,0.574648118934072,0.574648118934072,0.574648118934072,0.574648118934072,0.981590446000771,1,0.834179838499592,0.574648118934072,0.574648118934072,0.633643921604946,1,0.747670999825377,1,1,1,1,0.32505712305511,0.0198568229677331,1,1,1,1,1,0.519969326013879,0.517931306948641,0.658814221148576,0.673507296556022,1,0.747670999825377,1,0.50523719415697,1,1,0.229615009878363,1,0.715496780549313,1,0.780805610903317,0.49371730131101,0.0311195681995383,0.658814221148576,0.00234385879199632,0.00401820787789768,0.00401820787789768,1,1,1,0.146523739180251,1,0.339680470680681,0.394525452394585,1,0.0209912810621616,0.189426329899912,1,0.673507296556022,0.720314964256869,1,0.339680470680681,1,1,1,1,1,0.930496495532039,1,1,0.148365225233914,0.231262100972464,0.583051394030229,0.141673992049349,0.633643921604946,0.311316750092709,0.992658031035549,0.652910682745596,1,0.736505184596955,0.47735116742743,1,0.0013992318935521,0.00338309063230925,0.0624548933826278,0.574648118934072,1,1,0.448001124183083,1,0.547842620778006,0.790776259878129,1,0.00116013974025055,0.172794674081073,1,0.49371730131101,1,0.138164334679893,0.71380155882315,1,0.790776259878129,1,0.574648118934072,1,1,1,1,0.401648691880348,0.229615009878363,0.47735116742743,0.654669790000072,0.0383243951930968,0.0545823681746248,1,1,1,1,0.946746659326874,1,0.47735116742743,1,0.654669790000072,0.715496780549313,0.146523739180251,1,1,1,1,1,0.327750638084724,0.65495430991224,0.547842620778006,0.770134872881255,0.873857186297776,1,1,1,1,1,1,1,0.342956167852471,1,0.169674632473326,1,1,1,1,0.824136499914034,1,1,0.574648118934072,0.339680470680681,0.857549538428461,1,0.547842620778006,0.673507296556022,0.396345386375086,0.207544790502472,0.654669790000072,0.191935753755119,0.0383243951930968,1,0.394525452394585,1,0.720314964256869,1,1,1,1,1,0.715496780549313,0.280172446723863,0.272964939810861,0.673507296556022,0.790776259878129,0.218217812462477,0.254238668967444,0.574648118934072,1,0.391885947301562,1,1,0.226956431645038,0.596650837377633,0.146523739180251,1,0.857549538428461,0.000340085884589069,1,1,1,1,1,0.153411253617057,0.654669790000072,0.465515899213022,1,1,1,0.910410909086969,1,0.574648118934072,1,1,1,0.716514553737382,0.644549446941713,1,1,0.730979474597855,0.783108001432414,0.574648118934072,0.998117492042344,1,0.0198568229677331,0.189426329899912,0.992658031035549,0.0664094451193861,1,1,1,1,1,1,1,1,1,0.327750638084724,1,1,1,0.930496495532039,1,0.930496495532039,0.339680470680681,0.107262984229418,1,1,0.673507296556022,1,1,1,1,0.00263589794024896,1,1,1,0.224042635671759,1,0.574648118934072,1,0.654669790000072,0.467707324213199,1,1,1,0.557224737431753,0.32505712305511,0.114514763373154,0.50523719415697,0.462066783294068,0.17633896482951,0.644549446941713,1,1,0.415027515148953,0.132013133243781,1,0.318058653262959,0.114500463315992,0.153411253617057,0.228355101598346,0.715496780549313,0.00398323813773015,0.0031413370713233,0.644549446941713,0.613038498098036,1,1,0.00401820787789768,0.455495614917537,0.633643921604946,1,0.47735116742743,0.208455508298447,0.327750638084724,0.00338309063230925,0.339680470680681,0.391885947301562,0.574648118934072,1,1,1,1,1,1,0.857549538428461,1,0.228355101598346,1,1,1,0.47735116742743,1,1,0.857549538428461,0.526377655637847,1,1,1,1,1,1,0.930496495532039,0.715496780549313,0.49371730131101,1,0.44690705421303,1,0.715496780549313,1,1,0.946746659326874,0.574648118934072,0.661248058914455,0.141673992049349,0.790776259878129,0.574648118934072,0.981590446000771,1,0.574648118934072,1,1,1,0.863605773242549,1,1,1,0.0433499721555958,0.025324338050301,1,1,1,0.342541438398463,1,1,1,0.191935753755119,1,1,1,1,1,0.981590446000771,0.946746659326874,1,1,1,0.946746659326874,1,1,1,1,0.327750638084724,1,1,1,1,1,1,1,1,1,0.547842620778006,1,0.790776259878129,1,0.547842620778006,1,0.654669790000072,1,1,1,0.673507296556022,1,1,1,1,1,1,1,1,1,1,0.946746659326874,1,1,0.478128476077105,1,0.998125208307316,1,1,0.946746659326874,1,0.892491584867703,0.930496495532039,1,1,1,1,0.339680470680681,1,0.254923877675387,1,0.574648118934072,0.296889167804486,1,1)

# The expression_common.R file sources the DESeq_utils.R file that has the plotting functions we need
source('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/expression_common.R')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/bedtools/figures/DESeq/bedtools_max_groups_cutoff-0_LNCaP_group-PrEC_group_padj.pdf')

# Plot adjusted p-values on a histogram
pValHist(padj, "LNCaP_group vs PrEC_group 
adjusted p-values")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
