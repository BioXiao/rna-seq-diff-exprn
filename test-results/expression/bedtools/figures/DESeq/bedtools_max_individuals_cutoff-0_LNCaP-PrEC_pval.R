#/usr/bin/Rscript
# This script plots a histogram showing the distribution of p-values.
# Ideally, a p-value histogram would be flat (uniform distribution), with equal probability of every value.

# Vector of p-values
pval = c(0.683287332665675,1,1,0.437050626196062,1,0.211231164089008,0.0322852532193729,0.332054496831696,8.03761938811843e-10,0.437050626196062,0.496657488882385,0.0460443457233871,0.000121535992596147,0.680982871340429,0.382731694591506,0.20673417256274,1,0.193274590817463,0.00486955981442096,0.0571769511910932,0.0823771481375122,0.0817707307645003,0.190385751617123,0.951228232615344,0.169912434653059,0.524814742793478,0.244895287212766,0.00181005804701658,0.951143362212372,0.260387705612292,0.0063681853407262,0.000278490038355769,1.90017873069642e-06,0.420825532311219,0.144699383332857,4.59314548792266e-11,0.230934462217004,0.24312371839709,0.668648407080297,0.0130425128984744,0.00796414082959252,6.37698954476508e-10,0.351023783248475,1,0.0744322581087326,1,0.240450821383903,0.070762890752845,0.155482895978639,0.996060692920978,0.143058401215799,0.127956795929292,0.163783523540302,0.141108094182836,0.56505870725233,0.966076452370448,0.106987232630831,0.122682711699613,0.176600299114294,0.218096305864782,0.0245555152396166,0.374982515811461,0.210057447174718,0.734249750451969,0.0985273355818527,0.82108387729902,1,0.0597436065194957,0.0597436065194957,0.417022804223194,2.99714982633268e-35,0.218096305864782,0.0114149263036991,0.170373289247167,1.02625001996579e-05,0.983423844868523,0.195735370901508,0.564956288315811,0.000773725648623935,0.627596925398592,0.935046699800741,0.145977751369917,0.0103412713557536,1,3.14593041353685e-06,1,0.214727299248345,0.787920037920973,0.806610097940294,0.0246073589380734,0.797132594658361,0.261370139058986,0.523798269662165,0.848043831300617,1,0.681326801960669,0.343207744326606,0.176643744609003,0.809415884843788,0.0696732941848513,0.959801239222679,1,0.0330396946038887,5.15708126192996e-07,0.648650394109008,0.701156622837156,1,0.0672391595106842,0.150655578408565,0.349903765226096,1,0.495696380996243,0.144190465940991,0.18994793781203,1,1,0.397799784382121,1,0.00705942941343311,0.374445694013346,0.255609036274908,1,0.563543161265846,1,0.769023077673656,0.681278397247525,0.825823150564752,0.923694004121475,0.429145991029534,0.708589886398703,0.282660835211902,0.094685876598856,0.280510812789377,1,1,1,0.715029916007336,4.42258580923337e-11,0.00718250300413888,8.02774796272913e-10,0.140538815542096,0.465117408902606,0.823083901689977,0.898074301466351,1,0.000369877187964898,0.182428152412567,1,0.0595761771155398,0.00325316885803802,0.693015385068875,0.454197761004773,0.256956897436187,0.171002287570479,0.150519356813789,0.417022804223194,0.951317316130685,1,0.954907554332514,0.989405093025137,0.123170301394325,0.094708425966037,0.84996016943358,1.32840302548913e-07,0.485410440415983,1,0.0831691101644024,0.0585552323951037,0.968348911525426,0.76038311164039,0.734249750451969,1,0.260384127784054,1,0.0543027117422005,1,0.404786775231258,0.982907347363958,1,0.210741773021894,0.226985388876798,0.838121444465494,0.344645021734161,1,1,1,7.18390559137337e-05,1,0.347916811188334,0.437050626196062,0.0183725057784856,0.0761114108372312,1,1,0.776847118896328,0.84562479115237,1,0.741908390048453,0.417022804223194,0.00516176595761032,0.336934633638298,0.0815100878224533,2.08381712894621e-20,1.27354311749196e-47,0.567618719218228,1,0.437050626196062,0.0925318302523441,1,3.74705131918952e-20,0.996190580197043,0.472450171511202,0.146227002813231,0.73392615867578,0.396774664612544,0.875251241638494,0.902152410942561,1,0.451880006019238,0.404621974226694,0.872728478867456,0.982997412023624,0.73661394796467,0.158204658678677,1,0.0607877798235553,1,0.218511622180403,0.459788072626164,0.547442642922886,0.250460957660145,0.927750366655757,0.828480161539209,1,0.45988895873623,0.0114499259998187,0.204298030024366,1,0.0120972211817974,0.0796798989294428,0.666196003172922,0.563967143770343,1,0.000278280360625363,1.17834981274165e-07,0.808480532391674,0.748983022958106,0.288662890185582,0.163348534462164,0.674072743189764,0.828498264486797,0.330012350671141,0.264494711147589,0.445723603276246,0.320439479012711,0.197522314863213,0.0446952922528248,0.0259354743584985,0.681213966239254,0.052526570373586,1,0.021758429795398,0.437050626196062,0.437050626196062,1,0.437050626196062,0.710725838250652,1,0.442443900279784,0.183467278594136,0.52207997994234,0.529454229028763,1,0.65242130161443,0.186510553562954,0.0311511989353605,0.999041351861754,0.334006791262356,0.263690626597407,0.00666632340068995,0.914501282068746,0.813620920911018,0.0338543465758153,0.154898039429825,0.75896873739752,0.0257023252899397,1,0.596209202697244,0.249051432638438,1,0.0711514985317274,0.344986935593109,5.17491441804338e-15,0.437050626196062,1,0.0607566133568608,0.0820640780027378,4.42808775499368e-05,1,0.011713692366045,1,0.714310266587668,0.272161894167629,0.903250690181552,1,0.260516762399234,0.122221905932086,0.0434371390252597,0.0434371390252597,0.043555518110132,0.043555518110132,0.122221905932086,0.122221905932086,0.113025750901876,0.0311971041048328,0.0311971041048328,0.0311971041048328,0.0311971041048328,0.180554235909959,0.536157843663519,0.134690994054882,0.0259523358006396,0.0259523358006396,0.0333253564625456,0.27203640778418,0.0530495925178882,0.122506566140472,0.437050626196062,0.622855887554607,0.00404327533796423,3.66495790670372e-09,0.717371068010775,0.569790581579538,0.982997412023624,0.586049138289644,1,0.409841207389976,0.269302058143561,0.655390886450589,0.163485121995621,0.437050626196062,0.00617018586368752,0.575363741681863,0.010839770980103,1,0.437050626196062,0.000203846451058147,0.417022804223194,0.0925318302523441,0.417022804223194,0.110285579750328,0.00796414082959252,2.92965613791573e-05,0.021158128395653,6.86364318330592e-17,3.5007708224681e-23,3.5007708224681e-23,1,0.366381457749304,0.235409369584982,6.8322747718389e-07,0.513135835346753,0.111350706170439,0.175074225175287,0.767013503334912,0.0470938786397558,0.126367674397074,0.450062848099855,0.050373796310332,0.687572481441664,0.554117222591809,0.624534630426538,1,1,0.608402816647658,1,0.0595671691978221,1,1,9.8562851812167e-06,3.29429811199749e-05,0.0257023252899397,1.79124564795536e-05,0.00724161044276426,0.0012046857503444,0.71515126159027,0.360497347229847,0.902656240017644,0.503526935456921,0.421307892029296,0.903385169761833,2.47157736185654e-30,3.49362672025821e-14,1.84480583921438e-08,0.0253335485987389,1,1,0.00290434484017695,0.167523837468439,0.020025213054952,0.0121292529133733,0.828498264486797,7.61323558001486e-20,0.0630393751555801,0.331905934738068,6.47423767484033e-05,1,4.11306860017877e-06,0.011713692366045,0.254452756925709,0.405511650885374,0.92681247398497,0.0301884177884899,0.397674224516991,0.255518674312869,0.326481553908962,0.300541286742202,0.439781908508499,0.424319473111274,0.441783658990519,0.260077365705732,0.0942595861292061,0.11242127890059,1,1,1,0.674072743189764,1,0.290754684618999,1,0.68665294262612,0.428156992170768,0.126389157148074,1,0.767507403540194,0.56935992745106,1,0.927750366655757,0.00256524466972783,0.0437402513311637,0.0134569861054309,0.785784783505749,0.136158996305511,0.729669023871673,0.729669023871673,0.729669023871673,0.277367652132799,0.437050626196062,1,0.595483649683153,1.94707927223409e-05,1,0.129026411613886,0.65705634071474,0.723650822461343,0.382283640909873,0.771443970398874,0.926063547336953,0.411565707290475,0.289458544782247,0.535984733159714,0.653741735173307,0.808519172535618,0.265495630438206,0.000114148474225919,0.906270923723051,0.0075310875799272,0.27296682491856,0.171712474227053,0.531810606326648,0.305314155241044,0.19035171676119,0.592499438565991,0.836610173507279,0.537539595595843,0.916822120714603,0.904990701751983,1,0.943808490711144,0.216216548225855,0.364112073143262,6.90255401427055e-09,0.172411861923134,0.71371587958046,0.600047312688509,0.264192505551169,0.392193832672733,0.597520484682582,0.297584970965531,0.655160377780588,0.120368922087085,0.437050626196062,7.27982992430361e-05,0.375937831845552,6.82100264637431e-11,0.683287332665675,0.472603346454406,0.0332714625638583,0.966076452370448,0.6810652669701,1,0.433008774991818,1,0.294895293600607,0.751795534458066,0.343341711692858,0.722558778553489,0.950820454469661,0.597497847294287,0.573311594559527,0.140450568310428,0.0362925311125418,0.729650655304801,0.89141129595616,0.787919665477031,0.0797155996046058,0.728973450749186,0.838085061700283,0.437050626196062,0.527382893048086,0.809304892487718,0.756331401929882,0.520698299475548,0.180750797992169,0.184834575676593,0.940095112491727,0.406792523360858,0.475393384925636,1,1,0.54745494382792,1,1,1,1,0.565047099038241,0.00345331895407395,0.236792965973657,1,1,0.900165049401528,0.734249750451969,0.871465744644653,0.46845906341293,0.282952248064164,1,0.983423844868523,0.0707492340578671,0.900736330812378,0.730284214029285,0.982997412023624,1,0.0383964498204489,0.886536035676386,0.293216175945385,1,0.00339398572985968,0.565168548552278,0.337028813391541,0.436276181890804,1,1,0.800732836337959,0.343405939225723,0.223985440245931,0.213672799862349,0.445352895717123,0.2170729869177,0.173765374702125,0.415239380700327,0.565907449623164,0.862171874714663,0.535866725035519,0.307780160543076,0.550338018130503,0.375540368755026,0.249319111971341,0.409704550052475,0.49847176134833,0.594142143775284,0.00884518149045979,0.040243801494749,0.840927746529384,0.766220376196672,0.783356485849485,0.685703101386256,0.0756548487501064,0.176723937702672,0.336241722722748,0.982013371873191,0.280566480779222,0.189590777334439,0.136753496010679,0.0967441436695432,0.415740581336681,0.164011030818925,0.583987830509873,1,0.963788562459662,0.822490900579997,1,1,0.734249750451969,0.565168548552278,1,0.292785894478376,0.843663199150892,1,0.91761229447862,0.545039332789985,0.968051947549847,1,0.498682892841573,0.506038927354349,1,1,1,1,1,0.260288262433463,0.0925318302523441,0.00796414082959252,1,0.000266651814539493,0.838121444465494,0.210741773021894,0.156416360243102,0.70870445605692,0.744809367237195,0.0104303923494041,0.0479055063914535,9.52810948942107e-07,0.122221905932086,0.0311971041048328,0.180554235909959,0.536157843663519,0.0259523358006396,0.327702149088181,0.983423844868523,1,0.111373640033547,1,0.52847096304995,0.104366088690686,0.165556009591222,0.149021347131058,0.840570289561702,0.828497371761935,0.877916991687531,0.151326015074807,0.448615166880305,0.580339595753584,0.756537482473075,3.62367383453866e-15,1,0.729231077039687,1,1,0.982013371873191,0.077430016639274,0.498682892841573,1,1,1,0.53073907056061,0.938708549671118,0.843663199150892,0.362134526876019,0.0913289335073811,1,0.631161899302027,0.903223073159042,0.826070580438904,1,1,0.568959976675663,1,0.928482489352688,0.274208945912182,0.344986935593109,0.117481250152687,1,0.000433152139098863,1,0.0684992591086528,0.437050626196062,0.828497371761935,1,0.31973055390472,0.344986935593109,1,1,1,0.705769571490586,0.344986935593109,0.936363324396658,1,0.437050626196062,0.437050626196062,0.683287332665675,0.417022804223194,1,0.00102513051062872,0.180075866833793,1,0.734781132198793,0.674975964800102,1,0.0629958893482162,0.17363163705499,1,1,1,0.853827958294648,0.208377145047863,1,0.0623373317179936,1,0.286475626191222,0.10441474540918,1,1)

# The expression_common.R file sources the DESeq_utils.R file that has the plotting functions we need
source('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/expression_common.R')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/bedtools/figures/DESeq/bedtools_max_individuals_cutoff-0_LNCaP-PrEC_pval.pdf')

# Plot a histogram of the unadjusted p-values
pValHist(pval, "LNCaP vs PrEC 
unadjusted p-values")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
