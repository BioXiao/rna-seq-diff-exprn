#/usr/bin/Rscript
# This script plots a histogram showing the distribution of p-values.
# Ideally, a p-value histogram would be flat (uniform distribution), with equal probability of every value.

# Vector of p-values
pval = c(0.454593811661521,1,1,0.822264463649549,1,0.216730628153239,0.188966313146208,0.419655359120496,6.47924334505192e-05,0.822264463649549,0.499741452924074,0.0237906938750273,0.00133694749496527,0.792320597385689,0.40701338078579,0.151453457978816,1,0.499255419404495,0.00161239338419346,0.0169369280867634,0.279293855262565,0.055014339389061,0.123023715763898,1,0.209002872452079,0.200880717350493,0.260823127183059,0.0023256577475356,0.900970714057129,0.292669342612011,0.0458248204216596,0.00119929265768684,0.000111081759721676,0.600379239561081,0.157989539748096,0.0404064231088418,0.270401702222984,0.370945694284833,0.687058615144111,0.108771699453503,0.105362378939148,0.00014561766330566,0.273010237574884,0.968698914524428,0.0300545822057238,1,0.243974118925091,0.208311819893902,0.207352035959811,0.952394260807964,0.118914988243886,0.117004539589648,0.330575898760152,0.0997236875818195,0.826138531626673,1,0.098469316266505,0.479509478952928,0.269658857008922,0.65370254258213,0.147939552456761,0.324742221180521,0.270666772196445,0.947757439169624,0.131719807273392,0.757511902290282,1,0.163545601719436,0.163545601719436,0.772222664436561,0.000411630565263087,0.65370254258213,0.0207822650349885,0.219686094882902,0.00100465910185873,1,0.544410838911622,0.739106028306943,0.01989695790044,0.615665828748564,0.993608468120096,0.0888702536419788,0.0133473535455437,1,0.00187688615861151,1,0.373440759419503,0.819485577480113,0.913506576823732,0.264774347231849,0.842436264763109,0.415997331531154,0.498216640182907,0.797333426718936,0.990663437671098,0.740366181499737,0.349910274596593,0.232781276289489,0.859320612111583,0.100931521463873,1,1,0.0281148551899468,0.0141070822796855,0.655994536801165,0.636933865531436,1,0.0764329796709562,0.152589469172469,0.281338255577432,1,0.55746155169452,0.145115135497227,0.319125322948768,1,1,0.454593813165161,1,0.00462694497470732,0.51750008798255,0.256769486487214,1,0.623343150565308,1,0.834912144875923,0.57418743951378,0.773931178288401,0.977707627001081,0.578218811744508,0.865031963050565,0.164320114742072,0.224335866772619,0.395591618995969,1,1,1,0.718368530567266,0.00663451091493185,0.271127734302203,0.0158040577800414,0.524515026028599,0.442630903392087,0.776489065334204,0.822495557165924,1,3.07597754343082e-06,0.195040697042485,1,0.042173565138195,0.00531722264115172,0.665018974539328,0.44733772889011,0.254859380099647,0.187399427177824,0.169823170298016,0.772222664436561,1,1,0.925750755035375,1,0.0632216804384603,0.118092935054182,0.895659999849082,1.29924806703432e-09,0.437676180912419,1,0.143383845900752,0.0697913047739263,0.945655406113112,0.973195212269006,0.947757439169624,1,0.379800216733642,1,0.0562261791413986,1,0.541605157906578,1,1,0.258717031888671,0.229372231267442,0.953513301708146,0.717052175000882,1,1,1,0.026357957137854,1,0.337563061401452,0.822264463649549,0.0235787202031289,0.195840570000927,1,1,0.90676802162467,0.773292128026338,1,0.731312206133948,0.772222664436561,0.00848350781160789,0.377744119526627,0.236619363448271,0.00066980991818244,0.000775327754689963,0.629364201205345,1,0.822264463649549,0.270541270696029,1,1.03150529414169e-17,1,0.485221287711311,0.176112290835277,0.947757439169624,0.370552525118432,0.798434663328616,0.957197589587919,1,0.472361575718587,0.541605157906578,0.900818664528641,1,0.73450918593914,0.208114739606902,1,0.0514174416458297,1,0.206072407314109,0.780201007399707,0.761700017478735,0.165627182000788,1,0.953513301224797,1,0.772407557440422,0.0224296011623738,0.166580145536705,1,0.0158375419472393,0.0966484836504805,0.750447455079724,0.631156700251065,1,3.3778807212208e-05,4.96132730169041e-08,0.359238442496125,0.846451206542314,0.633100141634237,0.0250756446605309,0.658377737760156,0.792320597385689,0.0109375597557354,0.180092025682626,0.321876306232844,0.12158814361625,0.0821769558609907,0.199695330612981,0.130544736905592,0.792320597385689,0.000112271439352743,1,0.119578195680952,0.947757439169624,0.947757439169624,0.820438554524796,0.947757439169624,0.425655541562191,0.953513301708146,0.395612826945587,0.0166448544093519,0.216730628153239,0.260823126932596,1,0.831653034340685,0.425793000824826,0.329915452826099,0.32357773179944,0.0717839751057518,0.476519502491183,0.0431055543462834,1,0.498827197501038,0.00875969181187848,0.489046592547498,0.909280339354462,0.245541158231142,0.859127220901964,0.279848768603216,0.567165759085432,1,0.269186050170118,0.772407557440422,0.0199550168062777,0.822264463649549,1,0.32481497970464,0.028581466290155,0.00258524390496112,1,0.200183809525139,1,0.696988652639438,0.539073136965535,0.410169156003176,1,0.569556586680979,0.334267940222082,0.188271971585884,0.188271971585884,0.198159393425543,0.198159393425543,0.334267940222082,0.334267940222082,0.316882586009515,0.146622928361643,0.146622928361643,0.146622928361643,0.146622928361643,0.478022613676279,0.79652841489239,0.357179602531289,0.151464510937151,0.151464510937151,0.186365030343021,0.539188014523497,0.296613666141394,0.512060578618309,1,0.822264463649549,0.862927651864273,0.0480248553898111,0.000679097912713169,0.781481961104964,0.824781158221284,1,0.932607629800375,1,0.114521287945601,0.113363897553738,0.220849973287254,0.236619363448271,0.822264463649549,0.295934370468452,0.961172158853245,0.109894273421284,1,0.822264463649549,0.0292123063183143,0.772222664436561,0.270541270696029,0.772222664436561,0.311894990949068,0.105362378939148,0.00136227931926844,0.22170765855342,2.56509854117244e-05,9.83485938451098e-05,9.83485938451098e-05,1,0.741040132133682,0.536273697375334,0.0116075736127529,0.940969245849394,0.0550339484403834,0.0690824321566442,0.517405708085508,0.000753818209842054,0.0185728093756293,0.894075695810105,0.231689010495318,0.278273309191586,0.885307890624561,0.0558258568855908,1,1,0.871567240091659,1,1,0.432761805389581,0.675634445694018,1,0.0119747582610136,0.0298106663542137,0.160319193160159,0.0103416745585687,0.187393913698796,0.0442913023387712,0.490218261564751,0.208746219408583,1,0.289161406264468,0.0956782682925806,1,1.33989374211556e-05,6.449725966175e-05,0.00350294203650854,0.15639143821101,1,1,0.0839619069946407,0.654374073551413,0.126741733842686,0.333734035763956,0.792320597385689,9.52235080917007e-06,0.0156731912539347,0.987050688180869,0.104894266254245,1,0.00982837948475299,0.254548027438151,0.653307923218211,0.32436914590387,0.560176969844489,0.154585210490304,1,0.692489922334287,0.685198037568987,0.641215779571149,0.0725275339647139,0.0290227497884627,0.0939635615972336,0.214555318418899,0.00180914844664294,0.00298672329272913,1,1,1,1,0.454593811450203,0.792320597385689,0.094250197103954,0.792320597385689,0.216730627034939,0.269961214280107,0.0116256865560254,1,0.759786063842758,0.844331346327491,1,0.792320597877693,0.0502162400348689,0.217720789751948,0.127878453978914,0.306578998643564,0.388513796917616,0.631230355076169,0.631230355076169,0.631230355076169,0.608009519667375,0.822264463649549,1,0.992959065182411,0.0577067149738084,1,0.014855234580428,0.857213732648307,0.547078099016845,0.949344400019051,0.794627284592366,0.351751830332665,0.924623846047009,0.652896602825947,0.14754795041203,0.0538854232587855,0.372870162681282,0.732301293578492,0.129653588775096,0.233691595606738,0.0704854996289483,0.0223575381871413,0.213915149768882,0.0198532883977286,0.00188738471539191,0.565417576395938,0.0687858779807145,0.549620144740345,0.279198234129621,0.549268576994929,0.631217575886195,1,0.658377738036674,0.547430938286245,0.261340197043918,0.0379440112526162,0.0365944789349717,0.234470666930457,0.330551096320231,0.0250727117515885,0.033388388811046,0.156436355222818,0.646243721134994,0.0672101579075334,0.554118801190095,0.822264463649549,0.0270112305788212,0.168955845878482,0.011229338543982,0.658377738036674,0.377744118820713,1.8609350729908e-06,1,0.547078097655484,1,0.887687387282631,1,0.0128017598777572,0.215285995303354,0.0897917124337019,0.965707886080105,0.980419253548231,1,0.412238045017492,0.61158536837035,0.156191354732742,0.929031404361852,0.846072612001314,0.656476324828893,0.274451539051255,0.196710212091035,0.677959730778267,0.822264463649549,0.285991969541705,0.313885970478382,0.139486579812381,0.496919187783731,1,0.000632194752815829,0.0186575865291295,0.488841701335751,0.00381559055405501,0.883296462524838,0.923835822440739,1,0.909785251793517,0.792320597111289,0.974118056816262,0.851186347182243,1,0.547078098560208,0.0493596114986733,0.640863862596993,1,1,0.43278906768932,0.947757439169624,0.429492533211122,0.0558010063727234,0.00674979107326024,1,1,0.236787106997124,0.695899542914306,0.523812606606796,1,1,3.6058795352243e-05,0.541433060228402,1,1,0.0262732261088182,1,0.143955368966292,0.658377738036674,0.216730627896529,0.0908542271385421,1,0.953513301224797,0.725002690153683,0.13416081229547,0.04764809118617,0.00751943726663662,0.109380220234677,0.087862220079173,0.0165124190635835,0.201035942411369,1,1,0.0755111621269641,0.00921021859840335,0.827736057483155,0.0461206802269133,0.00736186289446185,0.0126706823699719,0.0281105829620799,0.273082902562597,8.1735392703081e-05,4.72704620855763e-05,0.193410953711267,0.175977567682194,0.628696292988943,0.547078099016845,9.89435592368786e-05,0.0859895962498223,0.186290222070104,1,0.095992642423847,0.0228131883226755,0.048922640050238,6.13344287376296e-05,0.05413282547418,0.067548056580023,0.144867779018738,1,0.730428593551293,0.640450856023037,1,1,1,0.377744118820713,0.953513301708146,0.0279661511813249,0.625485726437821,0.657880121893362,0.523906985753133,0.0951604117650706,0.703990832308737,0.957197589587919,0.377744119526627,0.117397044980677,1,1,1,1,1,1,0.43109168734108,0.270541270696029,0.105362378939148,1,0.0831454984582382,0.953513301708146,0.258717031888671,0.606492430335866,0.547078098560208,0.445205729306776,0.154227603026792,0.224270045261119,0.0104656574154102,0.334267940222082,0.146622928361643,0.478022613676279,0.79652841489239,0.151464510937151,0.794156176469033,1,1,0.382774651888626,1,0.92852760862969,0.513925897574021,0.00219418463715054,0.000980858563267397,1,0.953513301815251,0.903759798639337,0.0571683385562415,0.593117805706709,0.626771645107647,0.873365047621633,0.0196215072180538,1,0.929031404361852,1,1,1,0.478038575617339,0.454593813165161,1,1,1,0.454593813165161,0.953513301815251,1,0.953513301708146,0.672672988357461,0.0500479139229131,0.852439705702809,0.882211210310076,0.97391912457715,0.696988652639438,1,1,0.685390851229748,0.792320597111289,1,0.128960295610036,0.717052175000882,0.327091076670733,1,0.128633362853412,1,0.21354087131911,0.947757439169624,0.953513301815251,1,0.232679643038841,0.717052175000882,1,1,1,0.683303544511029,0.717052175000882,1,1,0.947757439169624,0.947757439169624,0.454593811661521,0.772222664436561,1,0.0974571038789173,1,0.501110740696012,1,0.964095009349228,0.454593813027977,1,0.400461340405754,0.431421569236571,0.835978538315604,1,1,0.826138531626673,0.0561435504883224,1,0.0338271082551471,1,0.154483955090318,0.0410202543751752,0.749908133872519,1)

# The expression_common.R file sources the DESeq_utils.R file that has the plotting functions we need
source('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/expression_common.R')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/bedtools/figures/DESeq/bedtools_max_groups_cutoff-0_LNCaP_group-PrEC_group_pval.pdf')

# Plot a histogram of the unadjusted p-values
pValHist(pval, "LNCaP_group vs PrEC_group 
unadjusted p-values")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
