#/usr/bin/Rscript
# This script plots a histogram showing the distribution of p-values adjusted by the Benjamini-Hochberg correction for controlling False Discovery Rate (FDR). 
#See http://en.wikipedia.org/wiki/False_discovery_rate for more information.
#Ideally, a p-value histogram would be flat (uniform distribution), with equal probability of every value.

# Vector of adjusted p-values
padj = c(1,1,1,0.862159978452341,1,0.640793699463294,0.228528949258698,0.803485701607177,3.22397844345639e-08,0.862159978452341,0.927961465545401,0.286586358726599,0.00214021918669313,1,0.855517905557484,0.64060975360643,1,0.609363557075144,0.0606176238967574,0.3356240549591,0.399169805069019,0.399169805069019,0.602888213454224,1,0.590716125098746,0.958183077042229,0.698871135840384,0.0256247433322739,1,0.709433234588676,0.0753742592787593,0.00446821794873034,5.08121867986227e-05,0.862159978452341,0.552753382362056,2.36875074448583e-09,0.672317265002728,0.69656874874087,1,0.117708678908731,0.0833349228835623,2.87761653207524e-08,0.80970981311629,1,0.383857788246464,1,0.691655350753698,0.369578287337462,0.569840867495318,1,0.552343131966883,0.516116238329324,0.583329873158934,0.54774217204305,0.974854976067362,1,0.476819641725061,0.5052781682199,0.590716125098746,0.643940372303064,0.19933602604321,0.845567335179091,0.640793699463294,1,0.447400857170425,1,1,0.336991280524031,0.336991280524031,0.862159978452341,1.0819710873061e-32,0.643940372303064,0.109834881666033,0.590716125098746,0.000239016940133967,1,0.614438859960386,0.974854976067362,0.0116381232980517,1,1,0.552753382362056,0.104593656614858,1,8.11200628062001e-05,1,0.643940372303064,1,1,0.19933602604321,1,0.709433234588676,0.958183077042229,1,1,1,0.803485701607177,0.590716125098746,1,0.369578287337462,1,1,0.229151498723409,1.55142194629726e-05,1,1,1,0.362288605721746,0.560294271200054,0.80970981311629,1,0.927961465545401,0.552753382362056,0.602888213454224,1,1,0.862159978452341,1,0.0804375806103969,0.845567335179091,0.709433234588676,1,0.974854976067362,1,1,1,1,1,0.862159978452341,1,0.729612582508309,0.43553811176738,0.728665464469779,1,1,1,1,2.36875074448583e-09,0.0804375806103969,3.22397844345639e-08,0.54774217204305,0.888398860390691,1,1,1,0.00580546368936209,0.595986995664584,1,0.336991280524031,0.0434960725093231,1,0.874482089187857,0.709433234588676,0.590716125098746,0.560294271200054,0.862159978452341,1,1,1,1,0.5052781682199,0.43553811176738,1,4.17003036697021e-06,0.915055712742402,1,0.40032065025799,0.336991280524031,1,1,1,1,0.709433234588676,1,0.321365228507121,1,0.862159978452341,1,1,0.640793699463294,0.663495752101409,1,0.803485701607177,1,1,1,0.00134770184752492,1,0.807703979671953,0.862159978452341,0.161767672830081,0.386989004397753,1,1,1,1,1,1,0.862159978452341,0.0631660173117738,0.803485701607177,0.399169805069019,2.50752661183194e-18,9.19498130829198e-45,0.974854976067362,1,0.862159978452341,0.433818061312938,1,3.86481578922119e-18,1,0.895589543674753,0.552753382362056,1,0.862159978452341,1,1,1,0.872345893972967,0.862159978452341,1,1,1,0.573988761638216,1,0.337605977173899,1,0.643940372303064,0.880742249887423,0.968780562362152,0.706378169650877,1,1,1,0.880742249887423,0.109834881666033,0.635789558955139,1,0.110852159537411,0.396928709755347,1,0.974854976067362,1,0.00446821794873034,3.8671298399976e-06,1,1,0.738477276794284,0.583329873158934,1,1,0.803485701607177,0.709907737726985,0.86741897996078,0.789615371492074,0.617364118317054,0.280608704404691,0.19933602604321,1,0.316034865081076,1,0.184818662497381,0.862159978452341,0.862159978452341,1,0.862159978452341,1,1,0.865703241197843,0.596681870022372,0.958183077042229,0.958183077042229,1,1,0.601163480680594,0.223012962016726,1,0.803485701607177,0.709907737726985,0.0776304112144862,1,1,0.230592813469233,0.569840867495318,1,0.19933602604321,1,0.99632745944763,0.705915289581602,1,0.369578287337462,0.803485701607177,3.39662564529756e-13,0.862159978452341,1,0.337605977173899,0.399169805069019,0.00088807759975151,1,0.109834881666033,1,1,0.719277545953287,1,1,0.709433234588676,0.5052781682199,0.277021591764036,0.277021591764036,0.277021591764036,0.277021591764036,0.5052781682199,0.5052781682199,0.488650252402125,0.223012962016726,0.223012962016726,0.223012962016726,0.223012962016726,0.593191255228844,0.958183077042229,0.53727567794268,0.19933602604321,0.19933602604321,0.229151498723409,0.719277545953287,0.316543849569548,0.5052781682199,0.862159978452341,1,0.0512148209475469,1.39268400454741e-07,1,0.974854976067362,1,0.990930861463988,1,0.862159978452341,0.717476332028232,1,0.583329873158934,0.862159978452341,0.0742479032263732,0.979746748807323,0.107209789693622,1,0.862159978452341,0.00350421756342815,0.862159978452341,0.433818061312938,0.862159978452341,0.487344049116489,0.0833349228835623,0.000622121097522105,0.181859151210256,5.50616708705208e-15,5.05511306764394e-21,5.05511306764394e-21,1,0.834471332791791,0.682592629880953,1.97316095410707e-05,0.947529598773288,0.487344049116489,0.590716125098746,1,0.29061350750345,0.512657143038819,0.87116722876165,0.305629251563527,1,0.974854976067362,1,1,1,1,1,0.336991280524031,1,1,0.000237207930027949,0.000679566639103482,0.19933602604321,0.000404149799319928,0.0804375806103969,0.0173956622349732,1,0.828914282483915,1,0.934566702827499,0.862159978452341,1,5.94826285086806e-28,2.10199874335536e-12,6.34261817101326e-07,0.19933602604321,1,1,0.0395648485775049,0.59001078366933,0.174195226815366,0.110852159537411,1,6.87094511096341e-18,0.342213750844578,0.803485701607177,0.00126335124357695,1,0.000102401225149278,0.109834881666033,0.709433234588676,0.862159978452341,1,0.223012962016726,0.862159978452341,0.709433234588676,0.801767625585955,0.750833249231384,0.865184027093015,0.862159978452341,0.865703241197843,0.709433234588676,0.43553811176738,0.488650252402125,1,1,1,1,1,0.73917212075675,1,1,0.862159978452341,0.512657143038819,1,1,0.974854976067362,1,1,0.0356174356066057,0.277021591764036,0.119949925532359,1,0.539541115408254,1,1,1,0.725577698695221,0.862159978452341,1,0.99632745944763,0.000425997343803943,1,0.517539273251253,1,1,0.855517905557484,1,1,0.862159978452341,0.738477276794284,0.958183077042229,1,1,0.709954982134757,0.00206037995977784,1,0.0823855338289006,0.719277545953287,0.590716125098746,0.958183077042229,0.760126965807014,0.602888213454224,0.99632745944763,1,0.958280464247404,1,1,1,1,0.643940372303064,0.831926951928592,2.49182199915167e-07,0.590716125098746,1,0.998235391154616,0.709907737726985,0.862159978452341,0.99632745944763,0.7460289897122,1,0.5052781682199,0.862159978452341,0.00134770184752492,0.845567335179091,3.28317594045484e-09,1,0.895589543674753,0.229151498723409,1,1,1,0.862159978452341,1,0.741862027803619,1,0.803485701607177,1,1,0.99632745944763,0.978560215772999,0.54774217204305,0.244889789376217,1,1,1,0.396928709755347,1,1,0.862159978452341,0.958183077042229,1,1,0.958183077042229,0.593191255228844,0.598433020800448,1,0.862159978452341,0.898518387215469,1,1,0.968780562362152,1,1,1,1,0.974854976067362,0.0445231479435963,0.683858085731923,1,1,1,1,1,0.892420696000358,0.729612582508309,1,1,0.369578287337462,1,1,1,1,0.256687377503371,1,0.740217059554434,1,0.0445231479435963,0.974854976067362,0.803485701607177,0.862159978452341,1,1,1,0.803485701607177,0.657388162022611,0.643940372303064,0.86741897996078,0.643940372303064,0.590716125098746,0.862159978452341,0.974854976067362,1,0.958183077042229,0.763633250557049,0.971501342518883,0.845567335179091,0.705915289581602,0.862159978452341,0.927961465545401,0.99632745944763,0.0912317290873139,0.266569033754209,1,1,1,1,0.386989004397753,0.590716125098746,0.803485701607177,1,0.728665464469779,0.602888213454224,0.539541115408254,0.442083998287406,0.862159978452341,0.583329873158934,0.989763412272602,1,1,1,1,1,1,0.974854976067362,1,0.740217059554434,1,1,1,0.968780562362152,1,1,0.927961465545401,0.936820783461128,1,1,1,1,1,0.709433234588676,0.433818061312938,0.0833349228835623,1,0.00446821794873034,1,0.640793699463294,0.570366727755148,1,1,0.104593656614858,0.29311674249686,2.64588271206231e-05,0.5052781682199,0.223012962016726,0.593191255228844,0.958183077042229,0.19933602604321,0.802037124209039,1,1,0.487344049116489,1,0.958183077042229,0.468245007362907,0.585938426102265,0.560294271200054,1,1,1,0.560294271200054,0.870699329267689,0.985894560315501,1,2.61629250853691e-13,1,1,1,1,1,0.39094036373116,0.927961465545401,1,1,1,0.958183077042229,1,1,0.830035328268208,0.433818061312938,1,1,1,1,1,1,0.974854976067362,1,1,0.719923123449438,0.803485701607177,0.504889658394286,1,0.0066539541367953,1,0.366344185751461,0.862159978452341,1,1,0.789615371492074,0.803485701607177,1,1,1,1,0.803485701607177,1,1,0.862159978452341,0.862159978452341,1,0.862159978452341,1,0.0151049842586518,0.593191255228844,1,1,1,1,0.342213750844578,0.590716125098746,1,1,1,1,0.640793699463294,1,0.342213750844578,1,0.736069046655026,0.468245007362907,1,1)

# The expression_common.R file sources the DESeq_utils.R file that has the plotting functions we need
source('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/expression_common.R')

# Open a pdf file to put the graphics we're about to create
pdf('/Users/olgabotvinnik/workspace/rna-seq-diff-exprn/test-results/expression/bedtools/figures/DESeq/bedtools_max_individuals_cutoff-0_LNCaP-PrEC_padj.pdf')

# Plot adjusted p-values on a histogram
pValHist(padj, "LNCaP vs PrEC 
adjusted p-values")

# Turn off the graphics device so the pdf is open-able.
# If you do not do this, your pdf reader will claim this file is corrupt and will not open it.
dev.off()
